!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("cuiLight",[],e):"object"==typeof exports?exports.cuiLight=e():t.cuiLight=e()}(window,(function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e),i.d(e,"CUI_LIGHT_VERSION",(function(){return Qo})),i.d(e,"init",(function(){return Zo})),i.d(e,"ElementManager",(function(){return Ut}));class s extends Error{constructor(t,e){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name=t}}class n extends s{constructor(t){super("ItemNotFoundError",t)}}class r extends s{constructor(t){super("ArgumentError",t)}}class o extends s{constructor(t){super("CuiInstanceInitError",t)}}class a extends s{constructor(t){super("RegisterElementError",t)}}class h extends s{constructor(t){super("AnimatorError",t)}}class c extends s{constructor(t){super("CSSVariableError",t)}}class l extends s{constructor(t){super("CuiPositionError",t)}}const u="dark",d="animation-progress",f="print",p="swiping-on",m="data-root",g={close:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path d="M 1.9999999,1.9999999 18,18"></path><path d="M 18,1.9999999 1.9999999,18"></path></svg>',accordion:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path d="M 5.0000475,7.4490018 10.000024,12.551028 15,7.4490018"></path></svg>',special_menu:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path class="menu_handle_2" d="M 1,10 H 19"></path><path class="menu_handle_1" d="M 1,4.8571429 H 19"></path><path  class="menu_handle_3" d="M 1,15.142857 H 19"></path></svg>',special_fail:'<svg xmlns="http://www.w3.org/2000/svg" class="special-fail" viewBox="0 0 100 100" width="100" height="100"><path class="circle" d="M 50,7.000001 A 43,43 0 0 1 92.999999,50 43,43 0 0 1 50,92.999999 43,43 0 0 1 7.0000011,50 43,43 0 0 1 50,7.000001 Z"></path><path class="arm_1" d="M 28.536809,28.536809 71.342023,71.342023"></path><path class="arm_2" d="M 71.342023,28.536809 28.536809,71.342023"></path></svg>',special_success:'<svg xmlns="http://www.w3.org/2000/svg" class="special-success" viewBox="0 0 100 100" width="100" height="100"><path class="circle" d="M 50,7 A 43,43 0 0 1 93,50 43,43 0 0 1 50,93 43,43 0 0 1 7,50 43,43 0 0 1 50,7 Z"></path><path class="arm" d="M 22.988405,48.234784 36.946233,72.410453 75.516456,33.84023"></path></svg>'},v=Object.freeze({fontSize:"--{prefix}-font-size",lineHeight:"--{prefix}-line-height",animationTime:"--{prefix}-animation-time",animationTimeLong:"--{prefix}-animation-time-long",animationTimeShort:"--{prefix}-animation-time-short",colorLightAppBackground:"--{prefix}-color-light-app-background",colorLightBackground:"--{prefix}-color-light-background",colorLightBorder:"--{prefix}-color-light-border",colorLightBase:"--{prefix}-color-light-base",colorLightActive:"--{prefix}-color-light-active",colorLightMuted:"--{prefix}-color-light-muted",colorDarkAppBackground:"--{prefix}-color-dark-app-background",colorDarkBackground:"--{prefix}-color-dark-background",colorDarkBorder:"--{prefix}-color-dark-border",colorDarkBase:"--{prefix}-color-dark-base",colorDarkActive:"--{prefix}-color-dark-active",colorDarkMuted:"--{prefix}-color-dark-muted",colorAccent:"--{prefix}-color-primary",colorAccentActive:"--{prefix}-color-primary-active",colorAccentMuted:"--{prefix}-color-primary-muted",colorAccentShade:"--{prefix}-color-primary-shade",colorAccentShadeDark:"--{prefix}-color-primary-shade-dark",colorSecondary:"--{prefix}-color-secondary",colorSecondaryActive:"--{prefix}-color-secondary-active",colorSecondaryMuted:"--{prefix}-color-secondary-muted",colorSecondaryShade:"--{prefix}-color-secondary-shade",colorSecondaryShadeDark:"--{prefix}-color-secondary-shade-dark",colorWarning:"--{prefix}-color-warning",colorWarningActive:"--{prefix}-color-warning-active",colorWarningMuted:"--{prefix}-color-warning-muted",colorWarningShade:"--{prefix}-color-warning-shade",colorWarningShadeDark:"--{prefix}-color-warning-shade-dark",colorSuccess:"--{prefix}-color-success",colorSuccessActive:"--{prefix}-color-success-active",colorSuccessMuted:"--{prefix}-color-success-muted",colorSuccessShade:"--{prefix}-color-success-shade",colorSuccessShadeDark:"--{prefix}-color-success-shade-dark",colorError:"--{prefix}-color-error",colorErrorActive:"--{prefix}-color-error-active",colorErrorMuted:"--{prefix}-color-error-muted",colorErrorShade:"--{prefix}-color-error-shade",colorErrorShadeDark:"--{prefix}-color-error-shade-dark",inputBackground:"--{prefix}-input-background-color",colorShade:"--{prefix}-color-shade",colorShadeDarker:"--{prefix}-color-shade-darker",colorShadeLight:"--{prefix}-color-shade-light",colorShadeLighter:"--{prefix}-color-shade-light-lighter",outline:"--{prefix}-outline",borderRadius:"--{prefix}-border-radius",padding:"--{prefix}-padding",margin:"--{prefix}-margin",scrollbarWidth:"--{prefix}-scrollbar-width",componentSpace:"--{prefix}-component-space",accordionIcon:"--{prefix}-accordion-icon"});class _{}_.logLevel="none",_.prefix="cui";const w=Object.freeze({INSTANCE_INITIALIZED:"instance-initialized",INSTANCE_FINISHED:"instance-finished",RESIZE:"resize",OPEN:"open",OPENED:"opened",CLOSE:"close",CLOSED:"closed",TOGGLE:"toggle",TOGGLED:"toggled",SWITCH:"switch",SWITCHED:"switched",ON_SCROLL:"scroll",TARGET_CHANGE:"targetchange",INTERSECTION:"intersection",KEYDOWN:"keydown",SCROLLBY:"scrollby",WINDOW_CLICK:"windowclick",OFFSET:"offset",PROGRESS_CHANGE:"progresschange",PROGRESS_CHANGED:"progresschanged",CHANGE:"change",CHANGED:"changed",GLOBAL_MOVE:"globalmove",MOVE_LOCK:"movelock",PAUSE:"pause",PAUSED:"paused",SORTED:"sorted",SORT_START:"sortstart",TOAST:"toast",TOAST_SHOW:"toastshow",TOAST_HIDDEN:"toasthidden",ALERT:"alert",GESTURE_DOWN:"gesture-down",GESTURE_UP:"gesture-up",GESTURE_LEFT:"gesture-left",GESTURE_RIGHT:"gesture-right",NOTIFY:"notify",NOTIFIED:"notified"}),b=function*(){let t=0;for(;;){((yield t++)||t>2e5)&&(t=0)}}(),y=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)};function x(t,e=!0){return null!=t&&(!e||!function(t){if("string"==typeof t)return 0===t.length;if("boolean"==typeof t)return t;if(Array.isArray(t))return 0===t.length;return!1}(t))}function C(t,e){if(!x(t)||!x(e))throw new r("Missing argument value");return`${t}-${e}`}function A(t){return new Promise(e=>setTimeout(()=>{e(!0)},t))}function k(t,e,i){return t<e?e:t>i?i:t}function E(t,e,i,s){return null==t||isNaN(t)?s:k(t,e,i)}function T(t){return x(t)?`[${t.join("],[")}]`:""}function S(...t){if(!x(t))return!1;let e=t.length;for(let i=0;i<e;i++)if(!x(t[i]))return!1;return!0}function P(t){let e="none";return t>=640&&(e="small"),t>=960&&(e="medium"),t>=1200&&(e="large"),t>=1600&&(e="xlarge"),e}function L(t,e){return t?t.split(e):[]}function I(t){let e={};return x(t)?(e=function(t){let e=null;if(x(t)&&t.startsWith("{")&&t.endsWith("}")){try{e=function(t){return t&&t.length>0?JSON.parse(t):{}}(t)}catch(t){console.error((i="An exception occured",s="Functions",n="parseJsonString",`[${(new Date).toLocaleString()}][${null!=s?s:"-"}][${null!=n?n:"-"}][${i}]`),t)}return e}var i,s,n;return null}(t.trim()),x(e)||(t.includes(";")||t.includes(":")?(e={},t.split(";").forEach(t=>{const i=function(t){let e=q(t);if(e.length<2)return;let i=e[0].trim(),s=e[1].trim();return{key:i,value:s.replace("U+0003B",";")}}(t);i&&(e[i.key]=i.value)})):e=t),e):e}function O(t){if(!x(t))return-1;let e=t.offsetTop-parseInt(N(t,"margin-top"))-parseInt(N(t,"padding-top"))-parseInt(N(t,"border-top-width"));return e<0?t.offsetTop:e}function M(t,e){if(!t)return e;let i=t.includes&&t.includes(".")?parseFloat(t):parseInt(t);return isNaN(i)?e:i}function N(t,e){return x(t)&&x(e)?t.currentStyle?t.currentStyle[e]:window.getComputedStyle?window.getComputedStyle(t,null).getPropertyValue(e):null:null}function H(t,e,i){return x(t)&&t>=e&&t<=i}function F(t,e){return S(t,e)?I(t.getAttribute(e)):null}function W(t){return!!x(t)&&["y","t","true","yes"].includes(t.toLowerCase())}function D(t,e){return x(t)?t.replace("{prefix}",null!=e?e:""):t}function R(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}function B(t){if(!x(t))return;let e=t.parentElement;return x(e)&&x(e.$cuid)?e:B(e)}function $(t){let e=0;return t?(Array.from(t.children).forEach(t=>{e+=t.getBoundingClientRect().height}),e>0?e+4:e):-1}function z(t,e){if(S(t,e))for(let i in t)t.hasOwnProperty(i)&&e(i,t[i])}function V(t,e,i){let s=-1;switch(t){case"prev":s=e<=0?i-1:e-1;break;case"next":s=e<i-1?e+1:0;break;case"first":s=0;break;case"last":s=i-1;default:s=E(t,0,i,-1)}return s}function q(t){let e=[];if(!x(t))return e;let i=t.split(":");return 1===i.length?i:[i.shift(),i.join(":")]}function U(t,e,...i){return i.includes(t)?t:e}function j(t){return":scope "+t}function K(t){const e=t.split(">");return e[e.length-1].trim()}function G(t){const e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}function Y(t,e){return[...t.querySelectorAll(e)]}function X(t){return(x(t)?[...document.querySelectorAll(t)]:[]).reduce((t,e)=>(e.$cuid&&t.push(e),t),[])}class Z{constructor(){this.autoLightMode=!1,this.scrollThreshold=20,this.resizeThreshold=20,this.prefix="cui",this.plugins={},this.root=document.body,this.parallaxAnimations={}}fromInit(t){var e;return this.prefix=null!==(e=t.prefix)&&void 0!==e?e:"cui",this.logLevel=t.logLevel,this.cacheSize=t.cacheSize,this.autoLightMode=t.autoLightMode,this.animationTime=t.animationTime,this.animationTimeShort=t.animationTimeShort,this.animationTimeLong=t.animationTimeLong,this.scrollThreshold=t.scrollThreshold,this.resizeThreshold=t.resizeThreshold,this.root=t.root,this.parallaxAnimations=t.parallaxAnimations,this}}class Q{constructor(){this.prefix="cui",this.app="$cui",this.logLevel="warning",this.interaction="async",this.animationTime=300,this.animationTimeShort=150,this.animationTimeLong=500,this.cacheSize=500,this.autoLightMode=!1,this.scrollThreshold=20,this.resizeThreshold=20,this.root=document.body,this.busSetup=void 0,this.development=void 0,this.parallaxAnimations={}}}class J{constructor(t,e){this._name=t,this._cuid="-",this._level=null!=e?e:_.logLevel}registerElement(t,e,i){this._cuid=e,console.log(this.prepString("Register element: "+e,"debug",i))}unregisterElement(t,e){this._cuid="-",console.log(this.prepString("Unregister element: "+t,"debug",e))}setProperty(t,e,i,s){}pushState(t,e,i,s,n){this.logByType(i,s,n)}log(t,e,i){this.logByType(t,e,i)}debug(t,e){"debug"===this._level&&console.log(this.prepString(t,"debug",e))}warning(t,e){"warning"!==this._level&&"debug"!==this._level||console.warn(this.prepString(t,"warning",e))}error(t,e){"error"!==this._level&&"debug"!==this._level&&"warning"!==this._level||console.error(this.prepString(t,"error",e))}exception(t,e){console.error(this.prepString(`An exception occured: ${t.name}: ${t.message}`,"exception",e)),"debug"===this._level&&console.error(t.stack)}setId(t){t&&(this._cuid=t)}prepString(t,e,i){return`[${(new Date).toLocaleString()}][${e}][${this._name}][${null!=i?i:"-"}][${this._cuid}][${t}]`}logByType(t,e,i){switch(t){case"debug":this.debug(e,i);break;case"warning":this.warning(e,i);break;case"error":this.error(e,i)}}}class tt{get(t){return new J(t)}}class et{static get(t){return _.devTool||(_.devTool=new tt),_.devTool.get(t)}}var it=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};function st(t,e){return e.filter(e=>t.hasAttribute&&t.hasAttribute(e.attribute))}function nt(t,e,i){return it(this,void 0,void 0,(function*(){if(!S(t,e,i))return!1;let s=t;s.$cuid||(s.$cuid=t.hasAttribute("cuid")?t.getAttribute("cuid"):function(t){return`${x(t)?t:"cui-element"}-${b.next().value}`}(t.tagName),t.setAttribute("cuid",s.$cuid));for(let t of e)yield ot(s,t,i,F(s,t.attribute));return!0}))}function rt(t){return it(this,void 0,void 0,(function*(){const e=t;if(!e.$handlers)return!1;for(let t in e.$handlers)yield ht(e,t);return!0}))}function ot(t,e,i,s){return it(this,void 0,void 0,(function*(){if(t.$handlers||(t.$handlers={}),t.$handlers[e.attribute])return!1;try{let n=e.get(t,i);t.$handlers[e.attribute]=n,yield t.$handlers[e.attribute].handle(s)}catch(t){throw new a(`An error occured during [${e.attribute}] initialization: ${t.message}`)}return!0}))}function at(t,e,i){return it(this,void 0,void 0,(function*(){if(!t||!t.$handlers)return!1;let s=t.$handlers[e];if(!s)return!1;try{s.refresh&&(yield s.refresh(i))}catch(t){throw new a(`An error occured during [${e}] update: ${t.message}`)}return!0}))}function ht(t,e){return it(this,void 0,void 0,(function*(){if(!t||!t.$handlers)return!1;let i=t.$handlers[e];if(!i)return!1;try{yield i.destroy()}catch(t){throw new a(`An error occured during [${e}] destroy: ${t.message}`)}return!0}))}var ct=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class lt{constructor(t,e){this._observer=void 0,this._plugins=void 0,this._options=void 0,this._element=t,this._log=et.get("CuiMutationObserver"),this._components=[],this._core=e,this._queryString=""}setPlugins(t){return this._plugins=t,this}setComponents(t){return this._components=t,this}setAttributes(t){return this._options={attributes:!0,subtree:!0,childList:!0,attributeFilter:t},this._queryString=T(t),this}start(){return this._log.debug("Starting"),this._options?(this._observer=new MutationObserver(this.mutationCallback.bind(this)),this._observer.observe(this._element,this._options),this._log.debug("Started"),this):(this._log.error("Cannot start - options are not defined"),this)}stop(){return this._log.debug("Stopping"),this._observer?(this._observer.disconnect(),this._observer=void 0,this._log.debug("Stopped"),this):(this._log.debug("Observer not available"),this)}mutationCallback(t,e){t.forEach(t=>{switch(t.type){case"attributes":const e=t.target;if(!S(t.attributeName,e)){this._log.error("Mutation attribute doesn't not exisist");break}this.handeComponentUpdate(t.attributeName,e);break;case"childList":this.handleChildListMutation(t)}x(this._plugins)&&this._plugins.onMutation(t).then(()=>{})})}handeComponentUpdate(t,e){let i=F(e,t);at(e,t,i).then(e=>{this._log.debug("Component: "+t+" updated with: "+e,"handeComponentUpdate")}).catch(t=>{this._log.exception(t)})}handleChildListMutation(t){return ct(this,void 0,void 0,(function*(){const e=t.addedNodes.length,i=t.removedNodes.length;if(e>0){this._log.debug("Registering added nodes: "+e);try{yield this.handleAddedNodes(t.addedNodes)}catch(t){this._log.exception(t)}}else if(i>0){this._log.debug("Removing nodes: "+i);try{yield this.handleRemovedNodes(t.removedNodes)}catch(t){this._log.exception(t)}}}))}handleAddedNodes(t){return ct(this,void 0,void 0,(function*(){for(let e of t){yield this.handleAddedNode(e);let t=e,i=t.hasChildNodes()?t.querySelectorAll(this._queryString):null;x(i)&&(this._log.debug("Additional nodes to add: "+i.length),yield this.handleAddedChildren(i))}return!0}))}handleAddedChildren(t){return ct(this,void 0,void 0,(function*(){let e=[];for(let i of t)e.push(yield this.handleAddedNode(i));return e}))}handleAddedNode(t){return ct(this,void 0,void 0,(function*(){let e=st(t,this._components);return nt(t,e,this._core)}))}handleRemovedNodes(t){return ct(this,void 0,void 0,(function*(){for(let e of t){yield rt(e);let t=e,i=e.hasChildNodes()?t.querySelectorAll(this._queryString):null;x(i)&&(this._log.debug("Additional nodes to remove: "+i.length),yield this.handleDestroyChildren(i))}return!0}))}handleDestroyChildren(t){return ct(this,void 0,void 0,(function*(){let e=[];for(let i of t)e.push(yield rt(i));return e}))}}class ut{constructor(){this._isScheduled=!1,this._writes=[],this._reads=[],this._limit=5,this._reportCallback=void 0}onError(t){this._reportCallback=t}mutate(t,e,...i){this._reads.push(this.createTask(t,e,...i)),this.schedule()}fetch(t,e,...i){this._writes.push(this.createTask(t,e,...i)),this.schedule()}createTask(t,e,...i){return e||i?t.bind(e,...i):t}run(t){let e=null;for(;e=t.shift();)e()}schedule(t){if(!this._isScheduled){if(this._isScheduled=!0,t&&t>=this._limit)throw new Error("Fast Dom limit reached");y(this.flush.bind(this,t))}}flush(t){let e=null!=t?t:0,i=null,s=this._writes,n=this._reads;try{this.run(n),this.run(s)}catch(t){this._reportCallback?this._reportCallback(t):console.error("An error has been captured in interactions: "+t.message),i=t}this._isScheduled=!1,(i||this._writes.length||this._reads.length)&&this.schedule(e+1)}}class dt{constructor(){this.isRunning=!1,this.tasks=[]}mutate(t,e,...i){this.tasks.push(this.createTask(t,e,...i)),this.schedule()}fetch(t,e,...i){this.tasks.push(this.createTask(t,e,...i)),this.schedule()}schedule(){this.isRunning||(this.isRunning=!0,y(this.flush.bind(this)))}flush(){let t=null;for(;t=this.tasks.shift();)try{t()}catch(t){}this.isRunning=!1}createTask(t,e,...i){return e||i?t.bind(e,...i):t}}var ft=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class pt{constructor(t){this._lock=!1,this._items=[],this._adapter=t,this._comparer=void 0,this._onError=void 0}add(t){this._items.push(t),this._lock||(this._lock=!0,this.flush().then(()=>{this._lock=!1}))}delete(t){const e=this._items.findIndex(e=>this.compare(e,t));if(!(e<0))return this._items.splice(e,1)[0]}isLocked(){return this._lock}setCompareCallback(t){this._comparer=t}onError(t){this._onError=t}compare(t,e){return this._comparer?this._comparer(t,e):Object.is(t,e)}flush(){return ft(this,void 0,void 0,(function*(){const t=this.getItemsForFlush();if(0===t.length)return!0;try{yield this._adapter.onFlush(t)}catch(e){this.callError(e,t)}return this.flush()}))}getItemsForFlush(){if("batch"===this._adapter.type){let t=[...this._items];return this._items=[],t}const t=this._items.shift();return t?[t]:[]}callError(t,e){this._onError&&this._onError(t,e)}}var mt=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class gt{constructor(t,e){this.log=et.get(t),this.queue=new pt(e),this.queue.onError(t=>{this.log.error(t,"Flush")})}handle(t,e,i){return mt(this,void 0,void 0,(function*(){return x(t)?(this.queue.add({events:t,cuid:e,args:i}),!0):(this.log.warning("No events provided"),!1)}))}}class vt{constructor(t){this.type="single",this._executor=t}onFlush(t){return mt(this,void 0,void 0,(function*(){for(const e of t)for(let t in e.events){let i=e.events[t];bt(e.cuid,i.$cuid)&&(yield this._executor.execute(i.callback,e.args))}return!0}))}}class _t{constructor(t){this.type="single",this._executor=t}onFlush(t){return mt(this,void 0,void 0,(function*(){for(const e of t){let t=[];for(let i in e.events){let s=e.events[i];bt(e.cuid,s.$cuid)&&t.push(this._executor.execute(s.callback,e.args))}yield Promise.all(t)}return!0}))}}class wt{static get(t,e){switch(t){case"tasked":return new gt("TaskedEventEmitHandler",new _t(e));default:return new gt("SimpleEventEmitHandler",new vt(e))}}}function bt(t,e){return!x(t)||x(t)&&t==e}var yt=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class xt{execute(t,e){return yt(this,void 0,void 0,(function*(){try{return t(e),!0}catch(t){}return!1}))}}var Ct=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class At{constructor(t,e){this._events={},this._eventHandler=t,this._name=null!=e?e:"CuiEventBus",this._log=et.get(this._name)}on(t,e,i){if(!S(t,e))throw new r("Missing argument");let s=this._name+"-"+function(){let t=R(1,1e3),e=R(1,100);return`${Math.floor(Math.random()*e)}-${Math.floor(t)}`}();return this._events[t]||(this._events[t]={}),this.isAttached(this._events[t],s,i)?null:(this._log.debug(`Attaching new event: [${t}] for: [${s}]`),this._events[t][s]={callback:e,$cuid:this.getCuid(i)},s)}detach(t,e){if(!S(t,e))throw new r("Missing argument");let i=this._events[t];this._log.debug(`Detaching item: [${e}] from [${t}]`),this.isAttached(i,e)&&delete i[e]}detachAll(t){x(t)&&this._events[t]?delete this._events[t]:this._log.error("Event name is missing or incorrect","detachAll")}emit(t,e,i){return Ct(this,void 0,void 0,(function*(){if(!x(t))throw new r("Event name is incorrect");let s=this._events[t];return x(s)&&(this._log.debug(`Emit: [${t}]`),yield this._eventHandler.handle(s,e,i)),!0}))}isSubscribing(t,e,i){let s=this._events[t];return this.isAttached(s,e,i)}detachByCuid(t,e){if(!S(t,e))return;let i=this._events[t];x(i)&&z(Object.assign({},i),(t,s)=>{s.$cuid===e&&delete i[t]})}isAttached(t,e,i){return x(i)?x(t)&&x(e)&&x(t[e])&&t[e].$cuid==i.$cuid:x(t)&&x(e)&&x(t[e])}getCuid(t){return x(t)?t.$cuid:null}}class kt{constructor(t){if(this._log=et.get("CuiEventBus"),this._buses=[],this._events={},this._last=0,x(t)){this._log.debug("Initiating buses"),(1===t.length?t:t.sort((t,e)=>t.priority-e.priority)).forEach((t,e)=>{this._buses.push(this.initBusInstance(t.name,t.handler)),this._events=Object.assign(Object.assign({},this._events),this.mapEvents(t.eventsDef,e)),this._log.debug(`Bus ${t.name} has been initialized with number: ${e}`)}),this._buses.push(this.initBusInstance("DefaultEventBus","tasked")),this._last=this._buses.length-1,this._log.debug("Bus initialization finished")}}on(t,e,i){if(!S(t,e))throw new r("Missing argument");return this.get(t).on(t,e,i)}detach(t,e,i){if(!S(t,e))throw new r("Missing argument");this.get(t).detach(t,e,i)}detachAll(t){this.get(t).detachAll(t)}emit(t,e,i){return Ct(this,void 0,void 0,(function*(){if(!x(t))throw new r("Event name is incorrect");return this.get(t).emit(t,e,i)}))}isSubscribing(t,e,i){return this.get(t).isSubscribing(t,e,i)}detachByCuid(t,e){S(t,e)&&this.get(t).detachByCuid(t,e)}initBusInstance(t,e){if(!S(t,e))throw new r("Bus name or handler name is incorrect");let i=new xt,s=wt.get(e,i);return new At(s,t)}mapEvents(t,e){return t.reduce((t,i)=>t[i]?t:Object.assign(Object.assign({},t),{[i]:e}),{})}get(t){let e=this._events[t];return this._buses[null!=e?e:this._last]}}new WeakMap,new WeakMap;class Et{constructor(t){}append(t){if(x(t)){const e=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style"),s=document.createTextNode(t);i.appendChild(s),e.appendChild(i)}return!0}}var Tt,St=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},Pt=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Lt{constructor(t,e){Tt.set(this,void 0),this.setup=(new Z).fromInit(t),this.interactions=class{static get(t,e){switch(t){case"async":const t=new ut;return e&&t.onError(e),t;default:return new dt}}}.get(t.interaction,this.onInteractionError.bind(this)),this.bus=class{static get(t){return x(t)?new kt(t):new At(wt.get("tasked",new xt))}}.get(t.busSetup),this.styleAppender=new Et(this.interactions),St(this,Tt,null!=e?e:[])}setLightMode(t){const e=C(this.setup.prefix,u),i=document.body.classList;"dark"!==t||i.contains(e)?"light"===t&&i.contains(e)&&this.interactions.mutate(()=>{i.remove(e)},this):this.interactions.mutate(()=>{i.add(e)},this)}getLightMode(){const t=C(this.setup.prefix,u);return document.body.classList.contains(t)?"dark":"light"}setPrintMode(t){const e=C(this.setup.prefix,f),i=document.body.classList;t&&!i.contains(e)?i.add(e):!t&&i.contains(e)&&i.remove(e)}isPrintMode(){const t=C(this.setup.prefix,f);return document.body.classList.contains(t)}setProperty(t,e){if(!S(t,e))throw new c("Property or value was not provided");let i=D(t,this.setup.prefix);this.interactions.mutate(()=>{document.documentElement.style.setProperty(i,e)},null)}isPlugin(t){return x(t)&&Pt(this,Tt).find(e=>e===t)}onInteractionError(t){console.error("An error has been captured from interactions"),console.error(t)}}Tt=new WeakMap;var It=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};function Ot(t){return{performActions:(e,i,s,n)=>new Promise(r=>{t.mutate(()=>{i.forEach(t=>t.add(e)),e.classList.add(d),setTimeout(()=>{!function(s){t.mutate(()=>{i.forEach(t=>t.remove(e)),e.classList.remove(d),n&&n(),s(!0)},null)}(r)},s)},null)})}}class Mt{constructor(t){this._interactions=t}performAction(t,e,i,s){return It(this,void 0,void 0,(function*(){return new Promise(n=>{this._interactions.mutate(()=>{e.add(t),t.classList.add(d),setTimeout(()=>{this._interactions.mutate(()=>{e.remove(t),t.classList.remove(d),s&&s(),n(!0)},null)},i)},null)})}))}performActions(t,e,i,s){return It(this,void 0,void 0,(function*(){return new Promise(n=>{this._interactions.mutate(()=>{e.forEach(e=>e.add(t)),t.classList.add(d),setTimeout(()=>{this._interactions.mutate(()=>{e.forEach(e=>e.remove(t)),t.classList.remove(d),s&&s(),n(!0)},null)},i)},null)})}))}performSwitchAction(t,e,i,s,n,r){return It(this,void 0,void 0,(function*(){return new Promise(o=>{this._interactions.mutate(()=>{i.forEach(e=>e.add(t)),t.classList.add(d),x(e)&&(s.forEach(t=>t.add(e)),e.classList.add(d)),setTimeout(()=>{this._interactions.mutate(()=>{i.forEach(e=>e.remove(t)),t.classList.remove(d),x(e)&&(s.forEach(t=>t.remove(e)),e.classList.remove(d)),n(),o(!0)},null)},r)},null)})}))}}var Nt,Ht=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},Ft=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Wt{constructor(t){Nt.set(this,void 0),Ht(this,Nt,t)}add(t,e){S(t,Ft(this,Nt))&&!t.classList.contains(Ft(this,Nt))&&t.classList.add(Ft(this,Nt))}remove(t,e){S(t,Ft(this,Nt))&&t.classList.contains(Ft(this,Nt))&&t.classList.remove(Ft(this,Nt))}toggle(t,e){S(t,Ft(this,Nt))&&(t.classList.contains(Ft(this,Nt))?t.classList.remove(Ft(this,Nt)):t.classList.add(Ft(this,Nt)))}}Nt=new WeakMap;class Dt{constructor(t){this._name=t}add(t,e){if(e)switch(this._name){case"dark-mode":e.setLightMode("dark");break;case"light-mode":e.setLightMode("light")}}remove(t,e){if(e)switch(this._name){case"dark-mode":e.setLightMode("light");break;case"light-mode":e.setLightMode("dark")}}toggle(t,e){if(e)switch(this._name){case"dark-mode":case"light-mode":this.setDarkMode(e)}}setDarkMode(t){"dark"===t.getLightMode()?t.setLightMode("light"):t.setLightMode("dark")}}class Rt{constructor(t){[this._attributeName,this._attributeValue]=q(t)}add(t,e){S(t,this._attributeName,this._attributeValue)&&t.setAttribute(this._attributeName,this._attributeValue)}remove(t,e){S(t,this._attributeName,this._attributeValue)&&t.hasAttribute(this._attributeName)&&t.removeAttribute(this._attributeName)}toggle(t,e){S(t,this._attributeName,this._attributeValue)&&(t.hasAttribute(this._attributeName)?t.removeAttribute(this._attributeName):t.setAttribute(this._attributeName,this._attributeValue))}}class Bt{constructor(t){[this._attributeName,this._attributeValue]=q(t)}add(t,e){if(!S(t,this._attributeName,this._attributeValue))return;let i=t;i.style&&!i.style[this._attributeName]&&(i.style[this._attributeName]=this._attributeValue)}remove(t,e){if(!S(t,this._attributeName,this._attributeValue))return;let i=t;i.style&&i.style[this._attributeName]&&(i.style[this._attributeName]="")}toggle(t,e){if(!S(t,this._attributeName,this._attributeValue))return;let i=t;i.style&&(i.style[this._attributeName]?delete i.style[this._attributeName]:i.style[this._attributeName]=this._attributeValue)}}class $t{constructor(){}add(t,e){}remove(t,e){}toggle(t,e){}}class zt{static get(t){if(!x(t))return new $t;switch(t[0]){case".":return new Wt(t.substring(1));case"~":return new Dt(t.substring(1));case"&":return new Rt(t.substring(1));case"^":return new Bt(t.substring(1));default:return new Wt(t)}}}class Vt{static get(t){if(!x(t))return[];return t.split(",").map(t=>zt.get(t.trim()))}}var qt=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Ut{constructor(t,e){this._elements=t,this._isLocked=!1,this._logger=et.get("ElementManager"),this._core=e,this._cDt=Date.now(),this._actionsHelper=new Mt(e.interactions)}toggleClass(t){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(e=>{e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)},"toggleClass")}))}toggleClassAs(t){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(e=>{let i=e.classList;this._core.interactions.fetch(()=>{i.contains(t)?this._core.interactions.mutate(i.remove,i,t):this._core.interactions.mutate(i.add,i,t)},this)},"toggleClassAs")}))}setClass(t){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(e=>{e.classList.contains(t)||e.classList.add(t)},"setClass")}))}setClassAs(t){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(e=>{let i=e.classList;this._core.interactions.fetch(()=>{i.contains(t)||this._core.interactions.mutate(i.add,i,t)},this)},"setClassAs")}))}removeClass(t){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(e=>{e.classList.contains(t)&&e.classList.remove(t)},"removeClass")}))}removeClassAs(t){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(e=>{let i=e.classList;this._core.interactions.fetch(()=>{i.contains(t)&&this._core.interactions.mutate(i.remove,i,t)},this)},"removeClass")}))}getAttribute(t){return x(t)?this._elements.reduce((e,i)=>{let s=i.getAttribute(t);return null!=s&&e.push(s),e},[]):[]}setAttribute(t,e){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(i=>{i.setAttribute(t,null!=e?e:"")},"setAttribute")}))}setAttributeAs(t,e){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(i=>{this._core.interactions.mutate(i.setAttribute,i,t,null!=e?e:"")},"setAttributeAs")}))}removeAttribute(t){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(e=>{e.removeAttribute(t)},"removeAttribute")}))}removeAttributeAs(t){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(e=>{this._core.interactions.mutate(e.removeAttribute,e,t)},"removeAttributeAs")}))}toggleAttribute(t,e){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(i=>{i.hasAttribute(t)?i.removeAttribute(t):i.setAttribute(t,null!=e?e:"")},"toggleAttribute")}))}toggleAttributeAs(t,e){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(i=>{this._core.interactions.fetch(()=>{i.hasAttribute(t)?this._core.interactions.mutate(i.removeAttribute,i,t):this._core.interactions.mutate(i.setAttribute,i,t,null!=e?e:"")},this)},"toggleAttributeAs")}))}click(t){return qt(this,void 0,void 0,(function*(){return!!x(t)&&this.call(e=>{e.addEventListener("click",t)},"click")}))}event(t,e){return qt(this,void 0,void 0,(function*(){return!(!x(t)||!x(e))&&this.call(i=>{i.addEventListener(t,e)},"event")}))}call(t,e){return qt(this,void 0,void 0,(function*(){return this._isLocked&&this._logger.error("Element is locked",e),this.lock(),this._elements.forEach((e,i)=>{t(e,i)}),this.unlock(),!0}))}setAction(t,e,i){return qt(this,void 0,void 0,(function*(){if(!x(t))return!1;let s=zt.get(t);return this.animate(e,i,t=>{s.add(t)})}))}removeAction(t,e,i){return qt(this,void 0,void 0,(function*(){if(!x(t))return!1;let s=zt.get(t);return this.animate(e,i,t=>{s.remove(t)})}))}animate(t,e,i){var s;return qt(this,void 0,void 0,(function*(){if(!x(t))return!1;const n=null!==(s=null!=e?e:this._core.setup.animationTime)&&void 0!==s?s:0,r=new Wt(t);return this.call(t=>this._actionsHelper.performAction(t,r,n,()=>{i&&i(t)}))}))}emit(t,...e){x(t)?this.call(i=>{let s=i.$cuid;x(s)&&(this._logger.debug(`Emitting event ${t} to ${s}`),this._core.bus.emit(t,s,...e))},"emit"):this._logger.warning("Not enough data to emit event","emit")}on(t,e){let i=[];return S(t,e)?(this.call(s=>{let n=s;if(x(n)){let s=this._core.bus.on(t,e,n);null!=s&&i.push(s)}},"on"),i):(this._logger.error("Incorrect arguments","on"),i)}detach(t,e){S(t,e)||this._logger.error("Incorrect arguments","detach"),this.call(i=>{let s=i;x(s)&&this._core.bus.detach(t,e,s)},"detach")}read(t,...e){this._core.interactions.fetch(t,this,...e)}change(t,...e){this._core.interactions.mutate(t,this,...e)}elements(){return this._elements}count(){return this._elements.length}lock(){this._isLocked=!0}unlock(){this._isLocked=!1}isLocked(){return this._isLocked}refresh(){return Date.now()-this._cDt<36e4}}var jt=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Kt{constructor(t){this._plugins=null!=t?t:[],this._log=et.get("CuiPluginManager"),this._mutated=[]}init(t){this._log.debug("Plugins initialization started: "+this._plugins.length),this._mutated=this._plugins.filter(t=>x(t.mutation)),this._plugins.forEach(e=>{e.init(t),t.setup.plugins[e.description]=e.setup}),this._log.debug("Plugins have been initialized")}get(t){if(x(t))return this._plugins.find(e=>e.name===t)}has(t){return x(this.get(t))}onMutation(t){return jt(this,void 0,void 0,(function*(){let e=[];return this._mutated.forEach(i=>{e.push(i.mutation(t))}),!(yield Promise.all(e)).find(t=>{})}))}}var Gt=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Yt{constructor(t,e){this._components=t,this._core=e}registerComponent(t){return Gt(this,void 0,void 0,(function*(){let e=st(t,this._components);return!(!e||0===e.length)&&nt(t,e,this._core)}))}updateComponent(t,e,i){return Gt(this,void 0,void 0,(function*(){return!!t.hasAttribute(e)&&at(t,e,i)}))}destroyComponent(t){return Gt(this,void 0,void 0,(function*(){return rt(t)}))}}var Xt=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Zt{constructor(t,e,i){_.prefix=t.prefix,_.logLevel=t.logLevel,t.development&&(_.devTool=t.development),this._plugins=new Kt(e),this._components=null!=i?i:[],this._core=new Lt(t,e.map(t=>t.name)),this._log=et.get("CuiInstance"),this._rootElement=t.root,this._mutationObserver=void 0,this._mutatedAttributes=[],this._api=new Yt(this._components,this._core)}init(){return Xt(this,void 0,void 0,(function*(){if(this._log.debug("Instance started","init"),!x(window.MutationObserver))throw new o("Mutation observer does not exists");this._mutatedAttributes=this._components.map(t=>t.attribute);const t=x(this._mutatedAttributes)?this._rootElement.querySelectorAll(T(this._mutatedAttributes)):null;if(x(t)){this._log.debug(`Initiating ${t.length} elements`);let e=[];for(let i of t)try{let t=st(i,this._components);e.push(nt(i,t,this._core))}catch(t){this._log.exception(t)}yield Promise.all(e)}return this._log.debug("Init plugins","init"),this._plugins.init(this._core),S(this._components,this._mutatedAttributes)&&(this._log.debug("Init mutation observer","init"),this._mutationObserver=new lt(this._rootElement,this._core),this._mutationObserver.setComponents(this._components).setAttributes(this._mutatedAttributes),this._mutationObserver.setPlugins(this._plugins),this._mutationObserver.start()),this._log.debug("Setting CSS globals","init"),this._core.interactions.mutate(()=>{this._core.setProperty(v.animationTimeLong,this._core.setup.animationTimeLong+"ms"),this._core.setProperty(v.animationTime,this._core.setup.animationTime+"ms"),this._core.setProperty(v.animationTimeShort,this._core.setup.animationTimeShort+"ms")},null),this._core.bus.emit(w.INSTANCE_INITIALIZED,null),this}))}finish(){this._mutationObserver&&this._mutationObserver.stop(),this._core.bus.emit(w.INSTANCE_FINISHED,null)}get(t){const e=this.all(t);if(!e)return;return new Ut(e,this._core)}all(t){const e=document.querySelectorAll(t);if(x(e))return[...e]}getUtils(){return this._core}on(t,e,i){return S(t,e)?this._core.bus.on(t,e,i):(this._log.error("Incorrect arguments","on"),null)}detach(t,e){S(t,e)||this._log.error("Incorrect arguments","detach"),this._core.bus.detach(t,e)}detachAll(t){x(t)||this._log.error("Incorrect arguments","detachAll"),this._core.bus.detachAll(t)}emit(t,e,...i){if(!S(t,e))return void this._log.warning("Not enough data to emit event","emit");let s=null;if("string"==typeof e&&e.startsWith("~"))s=e.substring(1);else{s=("string"==typeof e?document.querySelector(e):e).$cuid}x(s)?this._core.bus.emit(t,s,...i):this._log.warning("Element is not a cUI element","emit")}getPlugin(t){return this._plugins.get(t)}api(){return this._api}createCuiElement(t,e,i){return Xt(this,void 0,void 0,(function*(){if(!x(e)||!this._mutatedAttributes.includes(e))return this._log.error("Element cannot be created: Unknown attribute"),!1;let s=this._components.find(t=>t.attribute===e);return!!s&&(!!function(t,e,i){if(!S(e,i,t))return!1;if(t.hasAttribute(e))return!1;let s=[];return z(i,(t,e)=>{s.push(`${t}: ${e}`)}),t.setAttribute(e,s.join("; ")),!0}(t,e,i)&&nt(t,[s],this._core))}))}}const Qt={slide:{current:{left:{transform:{translateX:{from:0,to:-100,unit:"%"}}},right:{transform:{translateX:{from:0,to:100,unit:"%"}}}},previous:{left:{transform:{translateX:{from:100,to:0,unit:"%"}}},right:{transform:{translateX:{from:-100,to:0,unit:"%"}}}}},fade:{current:{left:{opacity:{from:1,to:0}},right:{opacity:{from:1,to:0}}},previous:{left:{opacity:{from:0,to:1}},right:{opacity:{from:0,to:1}}}},push:{current:{left:{transform:{translateX:{from:0,to:-10,unit:"%"}}},right:{transform:{translateX:{from:0,to:10,unit:"%"}}}},previous:{left:{transform:{translateX:{from:100,to:0,unit:"%"}}},right:{transform:{translateX:{from:-100,to:0,unit:"%"}}}}}};var Jt=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};function te(t){return Jt(this,void 0,void 0,(function*(){if(x(t.icons))for(let e in t.icons)g[e]=t.icons[e]}))}function ee(t){return Jt(this,void 0,void 0,(function*(){if(x(t.swipeAnimations))for(let e in t.swipeAnimations)Qt[e]=t.swipeAnimations[e]}))}function ie(t,e){return i=>Jt(this,void 0,void 0,(function*(){var s,n;try{t[e.app]=new Zt(e,null!==(s=i.plugins)&&void 0!==s?s:[],null!==(n=i.components)&&void 0!==n?n:[]),yield t[e.app].init()}catch(t){return console.error(t),t.message}}))}function se(t,e){return()=>Jt(this,void 0,void 0,(function*(){if(x(t[e]))return"Instance is already initialized"}))}var ne=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class re{constructor(t){this._onDestroy=void 0,this._callback=t.callback,this.name=t.name,this.description=t.description,this.setup=t.setup,this._extensions=[]}init(t){this._callback&&([this._extensions,this._onDestroy]=this._callback(t,this.setup)),this.forEachExtension(e=>e.init(t)).then(t=>{})}destroy(){this.forEachExtension(t=>t.finish()).then(t=>{}),this._onDestroy&&this._onDestroy()}forEachExtension(t){return ne(this,void 0,void 0,(function*(){if(!this._extensions||0===this._extensions.length)return!0;const e=[];return this._extensions.forEach(i=>{e.push(t(i))}),yield Promise.all(e),!0}))}}function oe(t){let e=void 0,i=null;function s(){var e;return{$cuid:null!==(e=t.id)&&void 0!==e?e:t.name}}return{init:n=>ne(this,void 0,void 0,(function*(){return e=n,!i&&(i=n.bus.on(t.name,t.callback,s()),!0)})),finish:()=>ne(this,void 0,void 0,(function*(){return!(!e||!i)&&(e.bus.detach(t.name,i,s()),i=null,!0)}))}}function ae(t){return{init:e=>ne(this,void 0,void 0,(function*(){return!t.listener.isAttached()&&(t.listener.attach(),!0)})),finish:()=>ne(this,void 0,void 0,(function*(){return!!t.listener.isAttached()&&(t.listener.detach(),!0)}))}}class he{constructor(t){this._tag=t,this._classes=[],this._attributes=void 0,this._id=void 0,this._text=void 0,this._children=[],this._rawChildren=[],this._evName=void 0,this._callback=void 0}setId(t){return this._id=t,this}setClasses(...t){return this._classes=t,this}setAttributes(t){return this._attributes=t,this}setTextContent(t){return this._text=t,this}setChildren(...t){return this._children=[...t],this}setRawChildren(...t){return this._rawChildren=[...t],this}onEvent(t,e){return this._evName=t,this._callback=e,this}build(t){let e=document.createElement(this._tag);return x(this._id)&&(e.id=this._id),x(this._classes)&&e.classList.add(...this._classes),x(this._attributes)&&z(this._attributes,(t,i)=>{e.setAttribute(t,i)}),x(t)?e.innerHTML=t:x(this._text)&&(e.textContent=this._text),this._rawChildren.forEach(t=>{e.appendChild(t.build())}),this._children.forEach(t=>e.appendChild(t)),S(this._evName,this._callback)&&e.addEventListener(this._evName,t=>{this._callback(t)}),e}}var ce,le,ue,de,fe,pe,me=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},ge=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class ve{constructor(t,e,i){ce.set(this,void 0),le.set(this,void 0),ue.set(this,void 0),de.set(this,void 0),fe.set(this,void 0),pe.set(this,void 0),me(this,de,t),me(this,ce,me(this,ue,me(this,le,void 0))),me(this,fe,null!=i?i:""),me(this,pe,e)}createHeader(t,e,i){x(e)||(e=[]),x(i)||(i=[]);let s=new he("div");s.setClasses(ge(this,de)+"-dialog-header",...e),me(this,ce,s.build());let n=new he("span").setClasses(this.getPrefixedString("-dialog-title")).build(t);ge(this,ce).appendChild(n),this.appendChildrens(ge(this,ce),...i)}createFooter(t,e){x(t)||(t=[]),x(e)||(e=[]),me(this,ue,new he("div").setClasses(this.getPrefixedString("-dialog-footer"),...t).build()),this.appendChildrens(ge(this,ue),...e)}createBody(t,e){x(t)||(t=[]),x(e)||(e=[]),me(this,le,new he("div").setClasses(this.getPrefixedString("-dialog-body"),...t).build()),this.appendChildrens(ge(this,le),...e)}build(t){let e=[this.getPrefixedString("-dialog")];ge(this,pe)&&e.push(this.getPrefixedString("-reverse-auto"));let i=new he("div").setId(t).setClasses(...e).setAttributes({[this.getPrefixedString("-dialog")]:ge(this,fe)}).build(),s=new he("div").setClasses(this.getPrefixedString("-dialog-container")).build();return ge(this,ce)&&s.appendChild(ge(this,ce)),ge(this,le)&&s.appendChild(ge(this,le)),ge(this,ue)&&s.appendChild(ge(this,ue)),i.appendChild(s),i}appendChildrens(t,...e){x(e)&&e.forEach(e=>t.appendChild(e))}getPrefixedString(t){return ge(this,de)+t}}ce=new WeakMap,le=new WeakMap,ue=new WeakMap,de=new WeakMap,fe=new WeakMap,pe=new WeakMap;var _e,we,be,ye,xe,Ce,Ae,ke,Ee=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},Te=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Se{constructor(t,e,i){_e.set(this,void 0),we.set(this,void 0),be.set(this,void 0),ye.set(this,void 0),xe.set(this,void 0),Ee(this,_e,{yes:i.onYes,no:i.onNo,cancel:i.onCancel,ok:i.onOk}),this.content=i.message,this.title=i.title,this.prefix=t.setup.prefix,Ee(this,we,t),Ee(this,be,e),this.reverse=!1,Ee(this,xe,null),this.closeStr=Te(this,we).setup.prefix+"-close",this.iconStr=Te(this,we).setup.prefix+"-icon",Ee(this,ye,void 0)}getId(){return Te(this,be)}show(t){if(!Te(this,we))return;let e=document.getElementById(Te(this,be));x(e)?this.updateElement(e):(e=this.createElement(),Te(this,we).interactions.mutate(()=>{t.appendChild(e)},null)),setTimeout(()=>{Ee(this,ye,new Ut([e],Te(this,we)));let t=Te(this,ye).on("closed",this.onClose.bind(this));Ee(this,xe,t.length>0?t[0]:null),Te(this,ye).emit("open")},50)}updateElement(t){Te(this,we).interactions.fetch(()=>{let e=t.querySelector(`.${this.prefix}-dialog-title`),i=t.querySelector(`.${this.prefix}-dialog-body>p`);Te(this,we).interactions.mutate(()=>{e&&(e.innerHTML=this.title),i&&(i.innerHTML=this.content)},null)},null)}onClose(t){try{if(x(t)&&t.state&&Te(this,_e)&&x(Te(this,_e)[t.state])){let e=Te(this,_e)[t.state];e&&e()}}finally{null!=Te(this,xe)&&(Te(this,ye)&&Te(this,ye).detach("closed",Te(this,xe)),Ee(this,xe,null)),Ee(this,ye,void 0)}}}_e=new WeakMap,we=new WeakMap,be=new WeakMap,ye=new WeakMap,xe=new WeakMap;class Pe extends Se{constructor(t,e,i){var s;super(t,e,i),Ce.set(this,void 0),Ee(this,Ce,e),this.reverse=null!==(s=i.reverse)&&void 0!==s&&s}createElement(){let t=new ve(this.prefix,this.reverse);return t.createHeader(this.title,[],[new he("a").setClasses(this.prefix+"-icon").setAttributes({[this.closeStr]:"state: cancel",[this.iconStr]:"close"}).build()]),t.createBody([],[new he("p").build(this.content)]),t.createFooter([this.prefix+"-flex",this.prefix+"-right"],[new he("button").setClasses(this.prefix+"-button",this.prefix+"-margin-small-right").setAttributes({[this.closeStr]:"state: cancel"}).build("Cancel"),new he("button").setClasses(this.prefix+"-button",this.prefix+"-accent").setAttributes({[this.closeStr]:"state: ok"}).build("Ok")]),t.build(Te(this,Ce))}}Ce=new WeakMap;class Le extends Se{constructor(t,e,i){var s;super(t,e,i),Ae.set(this,void 0),Ee(this,Ae,e),this.content=i.message,this.title=i.title,this.prefix=t.setup.prefix,this.reverse=null!==(s=i.reverse)&&void 0!==s&&s}createElement(){let t=new ve(this.prefix,this.reverse);return t.createHeader(this.title,[]),t.createBody([],[new he("p").build(this.content)]),t.createFooter([this.prefix+"-flex",this.prefix+"-right"],[new he("button").setClasses(this.prefix+"-button",this.prefix+"-accent").setAttributes({[this.closeStr]:"state: ok"}).build("Ok")]),t.build(Te(this,Ae))}}Ae=new WeakMap;class Ie extends Se{constructor(t,e,i){var s;super(t,e,i),ke.set(this,void 0),Ee(this,ke,e),this.content=i.message,this.title=i.title,this.prefix=t.setup.prefix,this.reverse=null!==(s=i.reverse)&&void 0!==s&&s}createElement(){let t=new ve(this.prefix,this.reverse);return t.createHeader(this.title,[],[new he("a").setClasses(this.prefix+"-icon").setAttributes({[this.closeStr]:"state: cancel",[this.iconStr]:"close"}).build()]),t.createBody([],[new he("p").build(this.content)]),t.createFooter([this.prefix+"-flex",this.prefix+"-right"],[new he("button").setClasses(this.prefix+"-button",this.prefix+"-margin-small-right").setAttributes({[this.closeStr]:"state: no"}).build("No"),new he("button").setClasses(this.prefix+"-button",this.prefix+"-accent").setAttributes({[this.closeStr]:"state: yes"}).build("Yes")]),t.build(Te(this,ke))}}ke=new WeakMap;function Oe(){return new re({name:"alert-plugin",description:"CuiAlertsPlugin",setup:void 0,callback:t=>{const e=et.get("CuiAlertsPlugin");return[[oe({name:w.ALERT,id:"alert-plugin",callback:function(i){if(!function(t){if(!(t&&t.id&&t.type&&t.options))return!1;return!0}(i))return void e.error("Event validation failed");let s=class{static get(t,e,i,s){return"Info"===e?new Le(s,t,i):"YesNoCancel"===e?new Ie(s,t,i):"OkCancel"===e?new Pe(s,t,i):void 0}}.get(i.id,i.type,i.options,t);s?s.show(t.setup.root):e.error("Possibly incorrect alert type")}})],void 0]}})}function Me(t){return new re({name:"focus-plugin",description:"CuiLightFocusPlugin",setup:Object.assign({keybordClass:"focus-visible",mouseClass:"focus-precise",touchClass:"focus-precise"},t),callback:(t,e)=>{let i=void 0,s="none";function n(n){let r=function(t,e){switch(t){case"keyboard":return e.keybordClass;case"mouse":return e.mouseClass;case"touch":return e.touchClass;default:return}}(n,e);!function(e,i,s){if(!t.interactions||e===i)return;t.interactions.fetch(()=>{let n=e&&document.body.classList.contains(e),r=i&&document.body.classList.contains(i);t.interactions.mutate(()=>{n||document.body.classList.add(e),r&&document.body.classList.remove(i),s()},null)},null)}(r,i,()=>{i=r,s=n})}function r(t){"mouse"!==s&&n("mouse")}function o(t){"keyboard"!==s&&n("keyboard")}function a(t){"touch"!==s&&n("touch")}return document.body.addEventListener("touchstart",a),document.body.addEventListener("mousedown",r),window.addEventListener("keydown",o),[[],()=>{document.body.removeEventListener("touchstart",a),document.body.removeEventListener("mousedown",r),window.removeEventListener("keydown",o)}]}})}var Ne,He,Fe,We,De,Re,Be,$e=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},ze=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Ve{constructor(t,e){Ne.set(this,void 0),He.set(this,void 0),Fe.set(this,void 0),We.set(this,void 0),De.set(this,void 0),Re.set(this,void 0),Be.set(this,void 0),$e(this,Fe,!1),$e(this,We,!0),$e(this,De,!1),$e(this,Ne,void 0),$e(this,He,null!=e?e:[]),$e(this,Re,this.onKeyDown.bind(this)),$e(this,Be,this.onKeyUp.bind(this))}setCallback(t){$e(this,Ne,t)}isInProgress(){return ze(this,Fe)}attach(){document.addEventListener("keydown",ze(this,Re)),ze(this,We)&&document.addEventListener("keyup",ze(this,Be)),$e(this,De,!0)}detach(){document.removeEventListener("keydown",ze(this,Re)),ze(this,We)&&document.addEventListener("keyup",ze(this,Be)),$e(this,De,!1)}isAttached(){return ze(this,De)}onKeyDown(t){if(!ze(this,Fe)){$e(this,Fe,!0);try{x(ze(this,He))&&!ze(this,He).includes(t.code)||!ze(this,Ne)||ze(this,Ne).call(this,t)}catch(t){console.error(t)}finally{ze(this,We)||$e(this,Fe,!1)}}}onKeyUp(t){$e(this,Fe,!1)}}Ne=new WeakMap,He=new WeakMap,Fe=new WeakMap,We=new WeakMap,De=new WeakMap,Re=new WeakMap,Be=new WeakMap;var qe,Ue,je=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},Ke=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Ge{constructor(t){qe.set(this,void 0),Ue.set(this,void 0),je(this,Ue,t),je(this,qe,new Ve(!0)),Ke(this,qe).setCallback(this.onKeyDown.bind(this))}connect(){Ke(this,qe).attach()}disconnect(){Ke(this,qe).detach()}onKeyDown(t){Ke(this,Ue).emit(w.KEYDOWN,null,{timestamp:Date.now(),name:w.KEYDOWN,source:"CuiKeysObserver",event:t})}}qe=new WeakMap,Ue=new WeakMap;var Ye,Xe=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},Ze=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Qe{constructor(t){Ye.set(this,void 0),this._mediaQuery=t,this._isInitialized=!1,this._callback=void 0,this._inProgress=!1,Xe(this,Ye,this.event.bind(this))}setCallback(t){this._callback=t}isInProgress(){return this._inProgress}attach(){window.matchMedia&&!this._isInitialized&&this._mediaQuery&&(window.matchMedia(this._mediaQuery).addEventListener("change",Ze(this,Ye)),this._isInitialized=!0)}detach(){this._isInitialized&&(window.matchMedia(this._mediaQuery).removeEventListener("change",Ze(this,Ye)),this._isInitialized=!1)}isAttached(){return this._isInitialized}event(t){if(!this._inProgress&&this._callback){this._inProgress=!0;try{this._callback(t)}catch(t){console.error(t)}finally{this._inProgress=!1}}}}function Je(t){return new re({name:"auto-light",description:"CuiAutoLightModePlugin",setup:t,callback:(t,e)=>{e.autoLight&&"dark"==(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")&&t.setLightMode("dark");const i=new Qe("(prefers-color-scheme: dark)");return i.setCallback((function(e){var i;let s=t.setup.plugins.CuiAutoLightModePlugin;null!==(i=null==s?void 0:s.autoLight)&&void 0!==i&&i&&t.setLightMode(e.matches?"dark":"light")})),[[ae({listener:i})],void 0]}})}Ye=new WeakMap;class ti{constructor(t){this._isLocked=!1,this._element=null!=t?t:document.body,this._isAttached=!1,this._preventDefault=!1,this._onEvent=void 0,this._target=void 0,this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this)}setCallback(t){this._onEvent=t}setTarget(t){this._target=t}isInProgress(){return this._isLocked}preventDefault(t){this._preventDefault=t}attach(){this._isAttached||(this._element.addEventListener("mousedown",this.onMouseDown,{passive:!1}),this._element.addEventListener("mouseup",this.onMouseUp,{passive:!1}),this._element.addEventListener("mousemove",this.onMouseMove,{passive:!1}),this._element.addEventListener("touchstart",this.onTouchStart,{passive:!1}),this._element.addEventListener("touchend",this.onTouchEnd,{passive:!1}),this._element.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this._isAttached=!0)}detach(){this._isAttached&&(this._element.removeEventListener("mousedown",this.onMouseDown,{passive:!1}),this._element.removeEventListener("mouseup",this.onMouseUp,{passive:!1}),this._element.removeEventListener("mousemove",this.onMouseMove,{passive:!1}),this._element.removeEventListener("touchstart",this.onTouchStart,{passive:!1}),this._element.removeEventListener("touchend",this.onTouchEnd,{passive:!1}),this._element.removeEventListener("touchmove",this.onTouchMove,{passive:!1}),this._isAttached=!1)}isAttached(){return this._isAttached}onMouseDown(t){this._isLocked||this._target&&!this._target.contains(t.target)||(this._isLocked=!0,this.publishMouseEvent("down",t))}onMouseUp(t){this._isLocked&&(this._isLocked=!1,this.publishMouseEvent("up",t))}onMouseMove(t){this._isLocked&&this.publishMouseEvent("move",t)}onTouchStart(t){this._isLocked||this._target&&!this._target.contains(t.target)||(this._isLocked=!0,this.publishTouchEvent("down",t))}onTouchEnd(t){this._isLocked&&(this._isLocked=!1,this.publishTouchEvent("up",t))}onTouchMove(t){this._isLocked&&this.publishTouchEvent("move",t)}publishMouseEvent(t,e){this._preventDefault&&e.cancelable&&e.preventDefault(),x(this._onEvent)&&this._onEvent({type:t,x:e.clientX,y:e.clientY,moveX:e.movementX,moveY:e.movementY,target:e.target,event:e})}publishTouchEvent(t,e){if(this._preventDefault&&e.cancelable&&e.preventDefault(),!x(this._onEvent))return;let i=null;e.touches.length>0?i=e.touches[0]:e.changedTouches.length>0&&(i=e.changedTouches[0]),this._onEvent({event:e,type:t,target:e.target,x:x(i)?i.clientX:-1,y:x(i)?i.clientY:-1,moveX:-1,moveY:-1})}}var ei,ii,si,ni,ri,oi,ai,hi=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},ci=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class li{constructor(t,e){ei.set(this,void 0),ii.set(this,void 0),si.set(this,void 0),ni.set(this,void 0),ri.set(this,void 0),oi.set(this,void 0),ai.set(this,void 0),hi(this,ei,t),hi(this,ii,new ti),ci(this,ii).setCallback(this.onMove.bind(this)),hi(this,ri,void 0),hi(this,si,!1),hi(this,ni,null),hi(this,oi,!1),hi(this,ai,e)}attach(){ci(this,ii).isAttached()||(ci(this,ii).attach(),hi(this,ni,ci(this,ei).on(w.MOVE_LOCK,this.onMoveLock.bind(this))))}detach(){ci(this,ii).isAttached()&&(ci(this,ii).detach(),null!=ci(this,ni)&&ci(this,ei).detach(w.MOVE_LOCK,ci(this,ni)))}isAttached(){return ci(this,ii).isAttached()}onMove(t){if(!ci(this,si))switch(t.type){case"down":hi(this,ri,t),hi(this,oi,!1);break;case"move":ci(this,ri)&&!ci(this,oi)&&(this.pushMoveEvent(ci(this,ri)),hi(this,oi,!0)),this.pushMoveEvent(t);break;case"up":if(this.pushMoveEvent(t),ci(this,ri)){if(ci(this,ai)){const{diffX:e,diffY:i}=this.getGestureDiff(ci(this,ri),t),s=this.calculateGesture(e,i);this.pushGestureEvent(s,e,i)}hi(this,ri,void 0)}}}pushMoveEvent(t){ci(this,ei).emit(w.GLOBAL_MOVE,null,Object.assign(Object.assign({},t),{source:"CuiMoveObserver",timestamp:Date.now(),name:w.GLOBAL_MOVE}))}onMoveLock(t){hi(this,si,t)}getGestureDiff(t,e){return{diffX:e.x-t.x,diffY:e.y-t.y}}calculateGesture(t,e){const i=.3*window.innerWidth,s=Math.abs(t),n=Math.abs(e);if(s>n&&s>i)return t>0?"right":"left";return n>.3*window.innerHeight?e>0?"down":"up":"none"}pushGestureEvent(t,e,i){const s=this.getGestureEventName(t);s&&ci(this,ei).emit(s,null,{timespstamp:Date.now(),changeX:e,changeY:i,name:s,source:"CuiMoveObserver"})}getGestureEventName(t){switch(t){case"up":return w.GESTURE_UP;case"down":return w.GESTURE_DOWN;case"left":return w.GESTURE_LEFT;case"right":return w.GESTURE_RIGHT;default:return null}}}ei=new WeakMap,ii=new WeakMap,si=new WeakMap,ni=new WeakMap,ri=new WeakMap,oi=new WeakMap,ai=new WeakMap;class ui{constructor(t){this._element=t,this._scale=1,this._appender=new di}setScale(t){return this._scale=t,this}build(){let t=function(t){if(!x(t))return null;let e=document.createElement("template");return e.innerHTML=t,e.content.children.length>0?e.content.children[0]:null}(this._element);return x(t)&&this._scale&&this._appender.append(t,this._scale),t}}class di{append(t,e){let i=M(t.getAttribute("width"),20),s=M(t.getAttribute("height"),20);t.setAttribute("width",(i*e).toString()),t.setAttribute("height",(s*e).toString())}}var fi=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};function pi(t,e,i,s){return fi(this,void 0,void 0,(function*(){let n=e.setup.prefix;if(!S(t.title,t.id))return;const r=[mi(t.title,i,s)];return x(t.message)&&r.push(function(t,e){return new he("div").setClasses(e.NOTIFICATION_BODY_CLS).setRawChildren(new he("div").setTextContent(t))}(t.message,i)),x(t.actions)&&r.push(function(t,e,i){return new he("div").setClasses(e.NOTIFICATION_FOOTER_CLS).setRawChildren(function(t,e){return new he("ul").setRawChildren(...t.map(t=>new he("li").setRawChildren(new he("a").onEvent("click",()=>{try{t.callback()}catch(t){et.get("Notifications").exception(t,"OnActionClick")}finally{e()}}).setTextContent(t.name))))}(t,i))}(t.actions,i,s)),new he("div").setClasses(i.NOTIFICATION_CLS,i.MARGIN_SMALL_VERTICAL,function(t,e){return`${t}-${null!=e?e:"default"}`}(n,t.type)).setId(t.id).setRawChildren(...r).build()}))}function mi(t,e,i){const s=new he("span").setClasses(e.NOTIFICATION_TITLE_CLS).setTextContent(t),n=new ui('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path d="M 3,3 17,17"></path><path d="M 17,3 3,17"></path></svg>').build(),r=new he("a").setClasses(e.ICON_CLS,e.NOTIFICATION_CLOSE_CLS).onEvent("click",i);n&&r.setChildren(n);return new he("div").setClasses(e.NOTIFICATION_HEADER_CLS).setRawChildren(s,r)}var gi=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};function vi(t){return new re({name:"notification-plugin",description:"CuiNotificationPlugin",setup:t,callback:(t,e)=>{var i;const s={NOTIFICATION_CLS:D("{prefix}-notification",n=t.setup.prefix),NOTIFICATION_HEADER_CLS:D("{prefix}-notification-header",n),NOTIFICATION_TITLE_CLS:D("{prefix}-notification-title",n),NOTIFICATION_BODY_CLS:D("{prefix}-notification-body",n),NOTIFICATION_FOOTER_CLS:D("{prefix}-notification-footer",n),NOTIFICATION_ACTIVE_CLS:D("{prefix}-active",n),NOTIFICATION_ANIMATION_IN:D("{prefix}-notification-animation-in",n),NOTIFICATION_ANIMATION_OUT:D("{prefix}-notification-animation-out",n),NOTIFICATION_ICON_CLS:D("{prefix}-notification-icon",n),NOTIFICATION_CLOSE_CLS:D("{prefix}-notification-close",n),ICON_CLS:D("{prefix}-icon",n),MARGIN_SMALL_VERTICAL:D("{prefix}-margin-small-vertical",n)};var n;const r=new Mt(t.interactions),o=null!==(i=e.timeout)&&void 0!==i?i:5e3;let a={},h=null;function c(e,i,n){if(!e)return;const r=a[e.id];r&&(i||clearTimeout(r.timeoutId),l(r.element,s.NOTIFICATION_ANIMATION_OUT).then(()=>{t.bus.emit(w.NOTIFIED,null,Object.assign(Object.assign({},e),{dissmissed:n})),r.element.remove(),delete a[e.id]}))}function l(e,i,s){return gi(this,void 0,void 0,(function*(){const n=null!=s?s:t.setup.animationTime,o=new Wt(i);return r.performAction(e,o,null!=n?n:0)}))}return function(t,e){h=document.getElementById("notifications-container"),h||(h=new he("div").setClasses(D("{prefix}-notification-container",t.setup.prefix)).build(),e.appendChild(h))}(t,document.body),[[oe({name:w.NOTIFY,id:"notification-plugin",callback:function(e){(function(t){return x(t)&&S(t.id,t.title)})(e)&&h&&(a[e.id]||pi(e,t,s,()=>{c(e,!1,!0)}).then(i=>{if(!i)return;var n;n=i,t.interactions.mutate(()=>{0===h.children.length?h.appendChild(n):h.insertBefore(n,h.firstChild)},null);let r=null;!1!==e.auto&&(r=function(t){return setTimeout(()=>{c(t,!0,!1)},o)}(e)),a[e.id]={element:i,timeoutId:r},l(i,s.NOTIFICATION_ANIMATION_IN).then(()=>{i.classList.add(s.NOTIFICATION_ACTIVE_CLS)})}))}})],()=>{h&&h.remove()}]}})}function _i(t){const e="CuiAutoPrintModePlugin";return new re({name:"auto-print",description:e,setup:t,callback:(t,i)=>{const s=new Qe("print");return s.setCallback(s=>{var n;null!==(n=null==(i=t.setup.plugins[e])?void 0:i.autoPrint)&&void 0!==n&&n&&(s.matches?t.setPrintMode(!0):t.setPrintMode(!1))}),i.autoPrint&&window.matchMedia&&window.matchMedia("print").matches&&t.setPrintMode(!0),[[ae({listener:s})],void 0]}})}var wi,bi,yi,xi,Ci,Ai,ki,Ei,Ti=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},Si=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Pi{constructor(t,e){wi.set(this,void 0),bi.set(this,void 0),yi.set(this,void 0),xi.set(this,void 0),Ci.set(this,void 0),Ai.set(this,void 0),ki.set(this,void 0),Ei.set(this,void 0),Ti(this,wi,[]),Ti(this,bi,[]),Ti(this,yi,window.innerWidth),Ti(this,xi,!1),Ti(this,Ci,P(window.innerWidth)),Ti(this,Ai,null!=e?e:0),Ti(this,ki,t),Ti(this,Ei,this.listener.bind(this))}observe(t){Si(this,wi).findIndex(e=>e===t)<0&&Si(this,wi).push(t)}unobserve(t){let e=Si(this,wi).findIndex(e=>e===t);e>=0&&Si(this,wi).splice(e,1)}connect(){window.addEventListener("resize",Si(this,Ei))}disconnect(){window.removeEventListener("resize",Si(this,Ei))}pushUpdateToItems(t){Si(this,wi).length<1||(Ti(this,bi,[]),Si(this,wi).forEach(e=>{Si(this,bi).push(e.resize(t))}),Promise.all(Si(this,bi)),Ti(this,bi,[]))}listener(t){if(Si(this,xi))return;Ti(this,xi,!0);const e=window.innerWidth-Si(this,yi);if(Math.abs(e)>=Si(this,Ai)){const t=P(window.innerWidth);if(t!==Si(this,Ci)){const e={current:t,previous:Si(this,Ci),width:window.innerWidth,height:window.innerHeight,timestamp:Date.now(),name:w.RESIZE,source:"CuiResizeObserver"};Si(this,ki).emit(w.RESIZE,"",e),this.pushUpdateToItems(e),Ti(this,Ci,t)}}Ti(this,xi,!1)}}function Li(t){return new re({name:"resize-observer-plugin",description:"CuiResizeObserverPlugin",setup:Object.assign({resizeThreshold:20},t),callback:(t,e)=>{const i=new Pi(t.bus,e.resizeThreshold);return i.connect(),[[],()=>{i.disconnect()}]}})}wi=new WeakMap,bi=new WeakMap,yi=new WeakMap,xi=new WeakMap,Ci=new WeakMap,Ai=new WeakMap,ki=new WeakMap,Ei=new WeakMap;var Ii,Oi,Mi,Ni,Hi,Fi,Wi,Di,Ri=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))},Bi=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},$i=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class zi{constructor(t,e,i){Ii.set(this,void 0),Oi.set(this,void 0),Mi.set(this,void 0),Ni.set(this,void 0),Hi.set(this,void 0),Fi.set(this,void 0),Wi.set(this,void 0),Di.set(this,void 0),Bi(this,Ii,t),Bi(this,Oi,`.${e}-toast`),Bi(this,Mi,e+"-toast"),Bi(this,Ni,e+"-active"),Bi(this,Hi,i),Bi(this,Fi,!1),Bi(this,Wi,e+"-toast-animation-in"),Bi(this,Di,e+"-toast-animation-out")}show(t){return Ri(this,void 0,void 0,(function*(){if($i(this,Fi))return!1;Bi(this,Fi,!0);let e=document.querySelector($i(this,Oi));return x(e)||(e=document.createElement("div"),e.classList.add($i(this,Mi)),document.body.appendChild(e),yield A(10)),$i(this,Ii).mutate(()=>{e.textContent=t,e.classList.add(d),e.classList.add($i(this,Wi))},this),yield A($i(this,Hi)),$i(this,Ii).mutate(()=>{e.classList.remove(d),e.classList.remove($i(this,Wi)),e.classList.add($i(this,Ni))},this),yield A(3e3),$i(this,Ii).mutate(()=>{e.classList.add(d),e.classList.add($i(this,Di))},this),setTimeout(()=>{$i(this,Ii).mutate(()=>{e.classList.remove(d),e.classList.remove($i(this,Di)),e.classList.remove($i(this,Ni))},this),Bi(this,Fi,!1)},$i(this,Hi)),!0}))}}function Vi(t){return new re({name:"toast-plugin",description:"CuiToastPlugin",setup:null!=t?t:{},callback:t=>{var e;const i=new zi(t.interactions,t.setup.prefix,null!==(e=t.setup.animationTime)&&void 0!==e?e:300);return[[oe({name:w.TOAST,id:"toast-plugin",callback:function(e){i&&(t.bus.emit(w.TOAST_SHOW,null,[]),i.show(e).then(()=>{t&&t.bus.emit(w.TOAST_HIDDEN,null,[])}))}})],void 0]}})}Ii=new WeakMap,Oi=new WeakMap,Mi=new WeakMap,Ni=new WeakMap,Hi=new WeakMap,Fi=new WeakMap,Wi=new WeakMap,Di=new WeakMap;class qi{constructor(t){this._keys=[],this._values=[],this._lock=!1,t&&t.forEach(t=>{if(!x(t.key))throw this._keys=[],this._values=[],new r("Key is empty");this.add(t.key,t.value)})}add(t,e){this.throwOnEmptyKey(t),this.lock(()=>{if(this.containsKey(t))throw new Error("Key already exists");this._keys.push(t),this._values.push(e)})}remove(t){this.throwOnEmptyKey(t),this.lock(()=>{let e=this._keys.indexOf(t);e<0||(this._keys.splice(e,1),this._values.splice(e,1))})}get(t){this.throwOnEmptyKey(t);let e=void 0;return this.lock(()=>{let i=this.indexOf(t);i>=0&&(e=this._values[i])}),e}containsKey(t){return x(t)&&this.indexOf(t)>=0}keys(){return[...this._keys]}values(){return[...this._values]}indexOf(t){return x(t)?this._keys.indexOf(t):-1}update(t,e){this.throwOnEmptyKey(t),this.lock(()=>{let i=this.indexOf(t);if(i<0)throw new n(`Item with key [${t}] not found`);this._values[i]=e})}clear(){this.lock(()=>{this._values=[],this._keys=[]})}forEach(t){this.lock(()=>{let e=this._keys.length;for(let i=0;i<e;i++)t(this._keys[i],this._values[i])})}checkLock(){if(this._lock)throw new Error("You cannot alter dictionary when is locked!")}lock(t){this.checkLock(),this._lock=!0;try{t()}catch(t){throw t}finally{this._lock=!1}}throwOnEmptyKey(t){if(!x(t))throw new r("Key is empty")}}var Ui,ji=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))},Ki=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},Gi=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Yi{constructor(){Ui.set(this,void 0),Ki(this,Ui,new qi)}add(t){Gi(this,Ui).add(t.type,t)}remove(t){Gi(this,Ui).remove(t)}init(t){return ji(this,void 0,void 0,(function*(){let e=[];return Gi(this,Ui).forEach((i,s)=>{s.init&&e.push(s.init(t))}),yield Promise.all(e),!0}))}update(t){return ji(this,void 0,void 0,(function*(){let e=[];return Gi(this,Ui).forEach((i,s)=>{s.update&&e.push(s.update(t))}),yield Promise.all(e),!0}))}destroy(){return ji(this,void 0,void 0,(function*(){let t=[];return Gi(this,Ui).forEach((e,i)=>{i.destroy&&t.push(i.destroy())}),yield Promise.all(t),!0}))}}Ui=new WeakMap;var Xi=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};function Zi(t,e,i){const s=[];return{emit:(n,r,o)=>Xi(this,void 0,void 0,(function*(){return s.includes(n)||s.push(n),e.emit(n,t,Object.assign(Object.assign({},r),{name:n,timestamp:Date.now(),source:null!=o?o:i}))})),on:(t,s)=>e.on(t,s,i),detach:(t,i)=>{null!=i&&(e.detach(t,i),i="")},detachEmittedEvents:()=>{s.forEach(i=>{e.detachByCuid(i,t)})}}}function Qi(t,e){return{mutate:(i,...s)=>{t.mutate(i,null!=e?e:null,...s)},fetch:(i,...s)=>{t.fetch(i,null!=e?e:null,...s)}}}class Ji{hasClass(t,e){return!(!t||!e.classList.contains(t))}setClass(t,e){this.setClasses([t],e)}setClasses(t,e){e&&e.classList.add(...t)}removeClass(t,e){this.removeClasses([t],e)}removeClasses(t,e){e&&e.classList.remove(...t)}}class ts{constructor(t,e){this._interactions=t,this._classesHelper=e}removeClasses(t,...e){this._interactions.mutate(this._classesHelper.removeClasses,this._classesHelper,e,t)}setClasses(t,...e){this._interactions.mutate(this._classesHelper.setClasses,this._classesHelper,e,t)}}class es{clean(t){t&&t.hasAttribute("style")&&t.removeAttribute("style")}setStyle(t,e,i){i&&i.style&&(i.style[t]=e)}removeStyle(t,e){e&&e.style&&e.style[t]&&delete e.style[t]}}class is{constructor(t,e){this._interactions=t,this._helper=e}setStyle(t,e,i){this._interactions.mutate(this._helper.setStyle,this._helper,t,e,i)}removeStyle(t,e){this._interactions.mutate(this._helper.removeStyle,this._helper,t,e)}setStyles(t,e){e.style&&this._interactions.mutate(()=>{t.forEach(t=>{t.key&&(e.style[t.key]=t.value)})},null)}removeStyles(t,e){e.style&&this._interactions.mutate(()=>{t.forEach(t=>{t&&delete e.style[t]})},null)}clean(t){this._interactions.mutate(this._helper.clean,this._helper,t)}}var ss=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class ns extends class extends class{constructor(t,e,i){var s;this.log=et.get(t),this.core=i,this.element=e,this.cuid=e.$cuid,this.activeClassName=(null!=(s=i.setup.prefix)?s:"")+"-active",this.componentName=t}}{constructor(t,e,i){super(t,e,i),this._isLocked=!1}getEventName(t){return[t,this.cuid].join("-")}getId(){return this.cuid}isActive(){return this.element.classList.contains(this.activeClassName)}lock(t){return this._isLocked?(this.log.warning("Component is locked: ",null!=t?t:""),!1):(this._isLocked=!0,this._isLocked)}unlock(t){return this._isLocked?(this._isLocked=!1,this._isLocked):(this.log.warning("Component is not locked: ",null!=t?t:""),!1)}logInfo(t,e){this.log.debug(t,e)}logWarning(t,e){this.log.warning(t,e)}logError(t,e,i){this.log.error(t,e),i&&this.log.exception(i,e)}}{constructor(t,e,i,s,n){super(t,e,n),this.args=s,this.classes=new Ji,this.asyncClasses=new ts(n.interactions,this.classes),this.prevArgs=void 0,this.isInitialized=!1,this.attribute=i,this._extensionHandler=new Yi,this.activeAction=zt.get(this.activeClassName)}handle(t){return ss(this,void 0,void 0,(function*(){return this.isInitialized?(this.logWarning("Trying to initialize handler again","handle"),!1):!!this.lock("handle")&&(this.log.registerElement(this.element,this.cuid,this.componentName),this.args.parse(t),this.element.classList.contains(this.attribute)||this.asyncClasses.setClasses(this.element,this.attribute),this.logInfo("Init","handle"),yield this._extensionHandler.init(t),this.performLifecycleOp("onHandle",this.onHandle(),()=>{this.unlock(),this.isInitialized=!0}))}))}refresh(t){return ss(this,void 0,void 0,(function*(){return this.logInfo("Update","refresh"),this.isInitialized?!!this.lock()&&(this.prevArgs=x(e=this.args)?Object.assign({},e):null,this.args.parse(t),this.log.debug("Component update","refresh"),yield this._extensionHandler.update(t),this.performLifecycleOp("onRefresh",this.onRefresh(),()=>{this.unlock()})):(this.logError("Cannot update not initialized component","refresh"),!1);var e}))}destroy(){return ss(this,void 0,void 0,(function*(){return this.logInfo("Destroy","destroy"),this.isInitialized?!!this.lock("destroy")&&(yield this._extensionHandler.destroy(),this.performLifecycleOp("onRemove",this.onRemove(),()=>{this.log.unregisterElement(this.cuid,this.componentName),this.isInitialized=!1,this.unlock(),this.element=null})):(this.logError("Cannot update not initialized component","destroy"),!1)}))}extend(t){if(this.isInitialized)throw new Error("Cannot extend initialized handler");this._extensionHandler.add(t)}performLifecycleOp(t,e,i){return ss(this,void 0,void 0,(function*(){let s=!1;try{s=yield e}catch(e){this.logError("An exception occured in"+t,t,e)}finally{i()}return s}))}}const rs={string:t=>t.trim().toLowerCase(),boolean:W,number:t=>{const e=t.includes(".")?parseFloat(t):parseInt(t);return isNaN(e)?void 0:e}};class os{constructor(t){this._options=null!=t?t:{},this._parser=new as(this._options.props),this._defaults={},this._defaultsLength=0}parse(t){if(this.fillDefaultValues(),t)if("string"==typeof t&&this._options.main){const e=typeof this[this._options.main];this[this._options.main]=this._parser.parseValue(this._options.main,t,e)}else z(this,(e,i)=>{const s=typeof i;if(!t[e])return void(this[e]=this._defaults[e]);const n=this._parser.parseValue(e,t[e],s);n&&(this[e]=n)})}fillDefaultValues(){0===this._defaultsLength&&(z(this,(t,e)=>{this._defaults[t]=e}),this._defaultsLength=Object.keys(this._defaults).length)}}class as{constructor(t){this._props=null!=t?t:{}}parseValue(t,e,i){var s,n,r;let o=this._props[t],a=rs[null!==(s=null==o?void 0:o.type)&&void 0!==s?s:i],h=null==a?void 0:a(e);return h?null!==(r=null===(n=null==o?void 0:o.corrector)||void 0===n?void 0:n.call(o,h))&&void 0!==r?r:h:null==o?void 0:o.default}}var hs=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};function cs(t){var e;function i(e){t.performer.perform(e)}return{type:null!==(e=t.type)&&void 0!==e?e:"click",init:()=>hs(this,void 0,void 0,(function*(){return t.element.addEventListener("click",i),!0})),destroy:()=>hs(this,void 0,void 0,(function*(){return t.element.removeEventListener("click",i),!0}))}}function ls(t){var e;const i=null!==(e=t.prefix)&&void 0!==e?e:"cui",s=i+"-"+t.name;return{attribute:s,get:(e,n)=>t.create(e,n,i,s),style:t.style}}class us{static setLabel(t,e){t.hasAttribute("aria-label")||t.setAttribute("aria-label",e)}static setAria(t,e,i){t.hasAttribute(e)||t.setAttribute(e,i)}static removeAria(t,e){t.hasAttribute(e)&&t.removeAttribute(e)}}var ds=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};function fs(t){return ps({onStart:e=>ds(this,void 0,void 0,(function*(){return t.onDown&&t.onDown(e),!0})),onMove:t.onMove,onEnd:t.onUp})}function ps(t){let e=!1,i=!0,s=!1;return{perform:n=>{if(i)switch(n.type){case"down":if(console.log("down"),e)return;s=!0,t.onStart(n).then(t=>{s=!1,t&&(e=!0)});break;case"move":if(!e)return;t.onMove&&t.onMove(n);break;case"up":if(!e&&!s)return;t.onEnd&&t.onEnd(n),e=!1}else e=!1},setEnabled:t=>{i=t}}}function ms(t,e){return{perform:i=>{e&&!0===e.ignoreEmpty&&!x(i)||t(i)}}}function gs(t,e,i){let s=null!=i?i:{},n=!1;function r(){e.onAfter&&e.onAfter(),n=!1}return{perform:i=>{var o,a;if(!s||!s.element||e.onBefore&&!e.onBefore(i)||n)return;n=!0;let h=!1;t.performActions(s.element,null!==(o=s.actions)&&void 0!==o?o:[],null!==(a=s.timeout)&&void 0!==a?a:0,r).then(t=>{h=t}).finally(()=>{h&&e.onFinish&&e.onFinish(i)})},updateSetup:t=>{s=Object.assign(Object.assign({},s),t)}}}function vs(t,e,i,s){return gs(t,Object.assign(Object.assign({},i),{onBefore:t=>!i.isActive()&&(!i.onBefore||i.onBefore(t)),onAfter:()=>{if(s.element&&(s.active&&s.active.add(s.element),us.setAria(s.element,"aria-hidden","false")),i.onAfter)return i.onAfter(),!1},onFinish:t=>{e.emit(w.OPENED,{state:t}),i.onFinish&&i.onFinish(t)}}),s)}function _s(t,e,i,s){return gs(t,Object.assign(Object.assign({},i),{onBefore:t=>!!i.isActive()&&(!i.onBefore||i.onBefore(t)),onAfter:()=>{if(s.element&&(s.active&&s.active.remove(s.element),us.setAria(s.element,"aria-hidden","true")),i.onAfter)return i.onAfter(),!1},onFinish:t=>{e.emit(w.CLOSED,{state:t}),i.onFinish&&i.onFinish(t)}}),s)}function ws(t,e){var i;let s=0,n=0;const r=null!==(i=e.moveThreshold)&&void 0!==i?i:.01,o=!0===e.prevent;let a=!1,h=0,c=0;function l(t){return a&&function(t){return t>=r}(Math.abs(t-n))}function u(t){o&&t.event.cancelable&&t.event.preventDefault()}function d(t,e){return Math.abs(t/e)}function f(t,e,i){return Math.abs((e-t)/i)}return fs({onDown:i=>{e.element.contains(i.target)&&(e.start()?(a=!0,s=i.x,c=performance.now(),t.setClasses(document.body,p),u(i)):a=!1)},onMove:t=>{const i=(t.x-s)/e.element.offsetWidth;if(!l(i))return;const r=performance.now()-c,o=d(n-i,r),a=f(h,o,r);n=e.adjustRatio?e.adjustRatio(i):i,e.progress({ratio:n,velocity:h,acceleration:a}),c=performance.now(),h=o,u(t)},onUp:i=>{if(!a)return;const r=i.x-s,o=performance.now()-c,l=d(r,o),m=f(h,l,o);e.end({ratio:n,velocity:h,acceleration:m}),s=0,n=0,h=0,c=0,a=!1,t.removeClasses(document.body,p),u(i)}})}var bs=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};function ys(t,e){var i;let s=null;function n(t){e.performer.perform(t)}return{type:null!==(i=e.type)&&void 0!==i?i:e.eventName,description:"",init:i=>bs(this,void 0,void 0,(function*(){return s=t.on(e.eventName,n),!0})),destroy:()=>bs(this,void 0,void 0,(function*(){return t.detach(e.eventName,s),!0}))}}var xs=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Cs extends os{constructor(t,e){super({props:{selector:{corrector:j},items:{corrector:j}}}),this.animation=!1,this.single=!1,this.selector=j(D("> * > .{prefix}-accordion-title",t)),this.items=j(D("> *",t)),this.timeout=null!=e?e:300,this.prevent=!1,this.stopPropagation=!1}}function As(t){return ls({prefix:t,name:"accordion",create:(t,e,i,s)=>new ks(t,e,s,i)})}class ks extends ns{constructor(t,e,i,s){super("CuiAccordionHandler",t,i,new Cs(s,e.setup.animationTime),e),this._currentIndex=-1,this._busFacade=Zi(this.cuid,e.bus,this.element),this._interactions=Qi(e.interactions,this),this.extend(cs({element:t,performer:ms(this.onElementClick.bind(this))})),this.extend(ys(this._busFacade,{eventName:w.SWITCH,performer:ms(this.switch.bind(this),{ignoreEmpty:!0})}))}onHandle(){return xs(this,void 0,void 0,(function*(){return this._currentIndex=this.getOpenedIndex(this.queryItems()),!0}))}onRefresh(){return xs(this,void 0,void 0,(function*(){return!0}))}onRemove(){return xs(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}switch(t){return xs(this,void 0,void 0,(function*(){if(!this.lock())return!1;this.log.debug("Switch to: "+t);const e=this.queryItems(),i=V(t,this._currentIndex,e.length);if(i<0)return!1;const s=e[i];return this._interactions.mutate(this.updateTargets,i,s,e),this._currentIndex=i,this._busFacade.emit(w.SWITCHED,{index:t,currentTarget:s,previousTarget:null,previous:-1}),this.unlock(),!0}))}updateTargets(t,e,i){this.toggleTarget(e)&&this.args.single&&this.closeAllExcept(t,i)}toggleTarget(t){return this.classes.hasClass(this.activeClassName,t)?(this.classes.removeClass(this.activeClassName,t),!1):(this.classes.setClass(this.activeClassName,t),!0)}closeAllExcept(t,e){e.forEach((e,i)=>{t!==i&&this.classes.hasClass(this.activeClassName,e)&&e.classList.remove(this.activeClassName)})}onElementClick(t){const e=t.target,i=K(this.args.selector);e.matches(i)&&this._interactions.fetch(()=>{const t=this.findMatchingTrigger(e);t>-1&&this.switch(t)})}findMatchingTrigger(t){return Y(this.element,this.args.selector).findIndex(e=>e===t)}queryItems(){return Y(this.element,this.args.items)}getOpenedIndex(t){return t.findIndex(t=>{this.classes.hasClass(this.activeClassName,t)})}}var Es,Ts,Ss=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},Ps=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Ls{constructor(){this.prop={from:0,to:0}}setProperty(t){if(!t||!x(t.from)||!x(t.to))throw new h("[OpacityAnimator] Property has incorrect format");this.prop=t}perform(t,e,i){this.prop.to<0||t.style&&(t.style.opacity=Ds(this.prop,e))}}class Is{constructor(t){if(!x(t))throw new h("[PropertyAnimator] Valid property is required");this.property=t,this.prop={from:0,to:0}}setProperty(t){if(!t||!x(t.from)||!x(t.to))throw new h("[PropertyAnimator] Property has incorrect format");this.prop=t}perform(t,e,i){this.property&&t.style&&(t.style[this.property]=Ds(this.prop,e))}}class Os{constructor(){this.prop=void 0}setProperty(t){if(!t)throw new h("[TransformAnimator] Property has incorrect format");this.prop=t}build(t){let e=[];for(let i in this.prop){let s=this.prop[i];e.push(this.buildSingle(i,Fs(s.from,s.to,t),s.unit))}return e.join(" ")}buildSingle(t,e,i){return`${t}(${Ws(e,i)})`}perform(t,e){this.prop&&t.style&&(t.style.transform=this.build(e))}}class Ms{constructor(t){Es.set(this,void 0),Ts.set(this,void 0),Ss(this,Es,{red:0,green:0,blue:0,alpha:0}),Ss(this,Ts,{red:0,green:0,blue:0,alpha:0}),this.id=t}perform(t,e,i){const s=Fs(Ps(this,Es).red,Ps(this,Ts).red,e),n=Fs(Ps(this,Es).blue,Ps(this,Ts).blue,e),r=Fs(Ps(this,Es).green,Ps(this,Ts).green,e),o=Fs(Ps(this,Es).alpha,Ps(this,Ts).alpha,e);t.style[this.id]=`rgba(${s},${r},${n},${o})`}setProperty(t){Ss(this,Es,Hs(t.from)),Ss(this,Ts,Hs(t.to))}}Es=new WeakMap,Ts=new WeakMap;class Ns{constructor(){this.property={}}perform(t,e,i){let s=[];z(this.property,(t,i)=>{s.push(`${t}(${Ds(i,e)})`)}),t.style.filter=s.join(" ")}setProperty(t){this.property=t}}function Hs(t){return{red:E(t.red,0,255,0),green:E(t.green,0,255,0),blue:E(t.blue,0,255,0),alpha:E(t.alpha,0,1,1)}}function Fs(t,e,i){return t+(e-t)*i}function Ws(t,e){return t+(null!=e?e:"")}function Ds(t,e){return Ws(Fs(t.from,t.to,e),t.unit)}new WeakMap,new WeakMap,new WeakMap;class Rs{static get(t){if(x(t)){if(t.includes("color"))return new Ms(t);switch(t){case"opacity":return new Ls;case"transform":return new Os;case"filter":return new Ns;default:return new Is(t)}}}}var Bs=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class $s{constructor(t){this._lock=!1,this._animationStart=null,this._currentTimestamp=null,this._timingFunction=t}animate(t,e,i){return new Promise((s,n)=>{this._lock?s(!1):(this._lock=!0,this._animationStart=i.progress*i.timeout+1e-4,y(this.performAsync.bind(this,t,e,i,s,n)))})}update(t,e,i){const s=this._timingFunction.calculateProgress(t);this.setValues(s,e,i)}finish(t,e){this._animationStart=null,this._currentTimestamp=null,this._lock=!1,e(!0)}setValues(t,e,i){i.forEach(i=>i.perform(e,t,1))}performAsync(t,e,i,s,n,r){if(null===this._animationStart)return void this.finish(t,s);this._currentTimestamp||(this._currentTimestamp=r);const o=r-this._currentTimestamp;this._animationStart=i.revert?this._animationStart-o:this._animationStart+o;const a=this._animationStart/i.timeout,h=k(this._timingFunction.calculateProgress(a),0,1);try{this.setValues(h,t,e)}catch(t){n(t)}if(a>0&&a<1)return this._currentTimestamp=r,void y(this.performAsync.bind(this,t,e,i,s,n));this.finish(t,s)}}class zs{constructor(t,e){this._element=void 0,this._animators=[],this._animationEngine=t}move(t){this._element&&0!==this._animators.length&&this._animationEngine.update(t,this._element,this._animators)}setElement(t){this._element=t}setProps(t){if(x(t)){this._animators=[];for(let e in t){let i=Rs.get(e);if(!i)return;i.setProperty(t[e]),this._animators.push(i)}}}updateAsync(t){y(this.move.bind(this,t))}finish(t){return Bs(this,void 0,void 0,(function*(){return!(!this._element||0===this._animators.length)&&this._animationEngine.animate(this._element,this._animators,t)}))}}function Vs(){return{calculateProgress:t=>2*t-Math.pow(t,2)}}var qs=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Us extends os{constructor(t,e){super(),this.timeout=null!=e?e:300,this.swipe=!1,this.closeAct=D(".{prefix}-animation-fade-out",t)}}function js(t){return ls({prefix:t,name:"banner",create:(t,e,i,s)=>new Ks(t,e,s,i)})}class Ks extends ns{constructor(t,e,i,s){super("CuiBannerHandler",t,i,new Us(s,e.setup.animationTime),e),this._swipeEngine=new zs(new $s({calculateProgress:t=>t})),this._swipeEngine.setElement(this.element),this._swipeAnimation=Qt.fade,this._interactions=Qi(e.interactions),this._busFacade=Zi(this.getId(),e.bus,t),this._movePerformer=ws(this.asyncClasses,{start:()=>!0,progress:this.onMove.bind(this),end:this.onUp.bind(this),element:t}),this._closeActionPerformer=_s(Ot(e.interactions),this._busFacade,{isActive:this.isActive.bind(this),onFinish:()=>{this._movePerformer.setEnabled(!1)}},{element:t,active:this.activeAction}),this.extend(ys(this._busFacade,{eventName:w.CLOSE,performer:this._closeActionPerformer})),this.extend(ys(this._busFacade,{eventName:w.GLOBAL_MOVE,performer:this._movePerformer}))}onHandle(){return qs(this,void 0,void 0,(function*(){return this._interactions.mutate(()=>{this.classes.hasClass(this.activeClassName,this.element)||this.classes.setClass(this.activeClassName,this.element),us.setAria(this.element,"aria-expanded","true"),us.setAria(this.element,"aria-hidden","false")}),this.updateSetup(),!0}))}onRefresh(){return qs(this,void 0,void 0,(function*(){return this.updateSetup(),!0}))}onRemove(){return qs(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}updateSetup(){this._movePerformer.setEnabled(this.args.swipe),this._closeActionPerformer.updateSetup({timeout:this.args.timeout,actions:Vt.get(this.args.closeAct)})}onMove(t){this._swipeEngine.setProps(t.ratio>0?this._swipeAnimation.current.right:this._swipeAnimation.current.left),this._interactions.mutate(()=>{this._swipeEngine.move(Math.abs(t.ratio))})}onUp(t){let e=Math.abs(t.ratio),i=e<=.4;const s=1/this.args.timeout,n=t.velocity>s?t.velocity:s;this._swipeEngine.finish({progress:e,acceleration:t.acceleration,velocity:n,timeout:this.args.timeout,revert:i}).then(t=>{t&&!i&&(this.asyncClasses.removeClasses(this.element,this.activeClassName),us.setAria(this.element,"aria-expanded","false"),us.setAria(this.element,"aria-hidden","true"),this._movePerformer.setEnabled(!1))})}}var Gs=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Ys extends os{constructor(){super(),this.progress=0}}function Xs(t){return g.special_circle_progress='<svg xmlns="http://www.w3.org/2000/svg"  class="circle-progress" viewBox="0 0 100 100" width="100" height="100"><path class="circle-progress-path" d="M 50,5.3660047 A 44.867708,44.633994 0 0 1 94.867709,49.999997 44.867708,44.633994 0 0 1 50,94.633995 44.867708,44.633994 0 0 1 5.1322908,50.000001 44.867708,44.633994 0 0 1 50,5.3660047"></path></svg>',ls({name:"circle-progress",prefix:t,create:(t,e,i,s)=>new Zs(t,e,s)})}class Zs extends ns{constructor(t,e,i){super("CuiCircleHandler",t,i,new Ys,e),this._factor=this._full=0,this._path=null,this._busFacade=Zi(this.cuid,e.bus,t),this._interactions=Qi(e.interactions,this),this.extend(ys(this._busFacade,{eventName:w.PROGRESS_CHANGE,performer:ms(this.onSetProgress.bind(this))}))}onHandle(){return Gs(this,void 0,void 0,(function*(){const t=new ui(g.special_circle_progress).build();if(!x(t))return this.logError("SVG circle was not created","onInit"),!1;const e=this.element.querySelector("svg");return x(e)&&e.remove(),this.element.appendChild(t),this._path=this.element.querySelector(".circle-progress-path"),this._full=this._path.getTotalLength(),this._factor=this._full/100,this._interactions.fetch(this.readStyle),!0}))}onRefresh(){return Gs(this,void 0,void 0,(function*(){return this._interactions.fetch(this.readStyle),this._busFacade.emit(w.PROGRESS_CHANGED,{timestamp:Date.now(),progress:this.args.progress}),!0}))}onRemove(){return Gs(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}onSetProgress(t){x(t)&&this.element.setAttribute(this.attribute,t)}updateStyle(t){this._path.style.strokeDashoffset=t}readStyle(){if(this.prevArgs&&this.args.progress===this.prevArgs.progress)return;const t=k(this.args.progress,0,100);this._interactions.mutate(this.updateStyle,this._full-this._factor*t)}}var Qs=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Js extends os{constructor(t){super({main:"target"}),this.target="",this.action="",this.prevent=!1,this.stopPropagation=!1,this.state="",this.timeout=null!=t?t:300}}function tn(t){return ls({prefix:t,name:"close",create:(t,e,i,s)=>new en(t,e,s)})}class en extends ns{constructor(t,e,i){super("CuiCloseHandler",t,i,new Js(e.setup.animationTime),e),this._busFacade=Zi(this.cuid,e.bus,t),this._actionsHelper=new Mt(e.interactions),this.extend(cs({element:t,performer:ms(this.onClose.bind(this))})),this.extend(ys(this._busFacade,{eventName:w.CLOSE,performer:ms(()=>this.onClose(null))}))}onHandle(){return Qs(this,void 0,void 0,(function*(){return!0}))}onRefresh(){return Qs(this,void 0,void 0,(function*(){return!0}))}onRemove(){return Qs(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}onClose(t){if(!this.lock())return;const e=this.getTarget();x(e)?this.run(e).then(e=>{e&&this.emitClose(t)}).catch(t=>{this.log.exception(t)}).finally(()=>{this.unlock()}):this.log.warning(`Target ${this.args.target} not found`,"onClick")}run(t){return Qs(this,void 0,void 0,(function*(){let e=t.$cuid;if(x(e))return yield this.core.bus.emit(w.CLOSE,e,this.args.state),!1;if(S(this.args.action,this.args.timeout)){let e=Vt.get(this.args.action);return this._actionsHelper.performActions(t,e,this.args.timeout,()=>{this.classes.removeClass(this.activeClassName,t)})}return this.asyncClasses.removeClasses(t,this.activeClassName),!0}))}getTarget(){var t;return x(this.args.target)&&null!==(t=document.querySelector(this.args.target))&&void 0!==t?t:B(this.element)}emitClose(t){this._busFacade.emit(w.CLOSED,{state:this.args.state,event:t})}}var sn=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class nn{constructor(t,e,i,s){var n,r;this.type="keys",this.description="",this._busFacade=e,this._performer=i,this._eventId=null,this._element=t,this._options={allowRepeatedEvent:null!==(n=null==s?void 0:s.allowRepeatedEvent)&&void 0!==n&&n,onlyWhenInViewport:null===(r=null==s?void 0:s.onlyWhenInViewport)||void 0===r||r}}init(t){return sn(this,void 0,void 0,(function*(){return this._eventId=this._busFacade.on(w.KEYDOWN,this.onKeyDown.bind(this)),!0}))}update(t){return sn(this,void 0,void 0,(function*(){return!0}))}destroy(){return sn(this,void 0,void 0,(function*(){return this._eventId&&this._busFacade.detach(w.KEYDOWN,this._eventId),this._eventId=null,!0}))}onKeyDown(t){this._options.onlyWhenInViewport&&G(this._element)&&(!this._options.allowRepeatedEvent||t.event.repeat)&&this._performer.perform(t)}}function rn(t){let e=[],i=t;return{perform:t=>{for(const r of e)if(s=t.event,void 0!==(n=r.value).key&&n.key===s.key&&s.ctrlKey===n.isCtrl&&s.altKey===n.isAlt&&s.shiftKey===n.isShift)return void i(r.key,t);var s,n},setKeyCombos(t){e=t},setCallback:t=>{i=t}}}function on(t){let e=0;return{getScroll:()=>{e=window.pageYOffset},freeze:()=>{t.setStyle("top",`-${e}px`,document.body)},release:()=>{t.removeStyle("top",document.body),window.scrollTo(0,-1*(e||0)),e=0}}}function an(t,e,...i){const s=[];return e&&s.push({key:"close",value:t.parse("Escape")}),i&&i.forEach(e=>{e&&s.push({key:"close",value:t.parse(e)})}),s}function hn(t){return{isAlt:!0,isCtrl:!0,isShift:!1,key:t}}function cn(t){let e=ln,i=null!=t?t:"+";return{parse:t=>L(t,i).reduce((t,i)=>function(t,i){let s=i.trim();const n=e[s.toLowerCase()];return n?t=n(t,s):t.key=s,t}(t,i),{isCtrl:!1,isAlt:!1,isShift:!1})}}const ln={ctrl:function(t,e){return t.isCtrl=!0,t},alt:function(t,e){return t.isAlt=!0,t},shift:function(t,e){return t.isShift=!0,t}};var un=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class dn extends os{constructor(t,e){super(),this.escClose=!1,this.timeout=null!=e?e:300,this.openAct=D(".{prefix}-dialog-default-in",t),this.closeAct=D(".{prefix}-dialog-default-out",t),this.keyClose=""}}function fn(t){return ls({prefix:t,name:"cover",create:(t,e,i,s)=>new pn(t,e,s,i)})}class pn extends ns{constructor(t,e,i,s){super("CuiCoverHandler",t,i,new dn(s,e.setup.animationTimeLong),e),this._bodyClass=D("{prefix}-cover-open",s),this._busFacade=Zi(this.cuid,e.bus,t),this._keysPerformer=rn(this.closeOutside.bind(this)),this._freezeHelper=on(new es),this._keyComboParser=cn();const n=Ot(e.interactions);this._openActionPerformer=vs(n,this._busFacade,{isActive:this.isActive.bind(this),onBefore:this.onBeforeOpen.bind(this),onAfter:this.onAfterOpen.bind(this)},{element:t,active:this.activeAction}),this._closeActionPerformer=_s(n,this._busFacade,{isActive:this.isActive.bind(this),onAfter:this.onAfterClose.bind(this)},{active:this.activeAction,element:t}),this.extend(ys(this._busFacade,{eventName:w.OPEN,performer:this._openActionPerformer})),this.extend(ys(this._busFacade,{eventName:w.CLOSE,performer:this._closeActionPerformer})),this.extend(new nn(t,this._busFacade,this._keysPerformer))}onHandle(){return un(this,void 0,void 0,(function*(){return us.setAria(this.element,"aria-modal",""),this.updateSetup(),!0}))}onRefresh(){return un(this,void 0,void 0,(function*(){return this.updateSetup(),!0}))}onRemove(){return un(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}updateSetup(){this._openActionPerformer.updateSetup({timeout:this.args.timeout,actions:Vt.get(this.args.openAct)}),this._closeActionPerformer.updateSetup({timeout:this.args.timeout,actions:Vt.get(this.args.closeAct)}),this._keysPerformer.setKeyCombos(an(this._keyComboParser,this.args.escClose,this.args.keyClose))}closeOutside(){this._closeActionPerformer.perform(null)}onBeforeOpen(){return!this.isAnyActive()&&(this._freezeHelper.getScroll(),!0)}onAfterOpen(){this.classes.setClass(this._bodyClass,document.body),this._freezeHelper.freeze(),this.classes.setClass(this.activeClassName,this.element),us.setAria(this.element,"aria-hidden","false"),us.setAria(this.element,"aria-expanded","true")}onAfterClose(){this._freezeHelper.release(),this.classes.removeClass(this._bodyClass,document.body),us.setAria(this.element,"aria-hidden","true"),us.setAria(this.element,"aria-expanded","false")}isAnyActive(){return this.classes.hasClass(this._bodyClass,document.body)}}function mn(t,e){return function(t){let e=!1;return{perform:i=>{e&&t(i)},setEnabled:t=>{e=t}}}((function(i){e&&e.contains(i.ev.target)||t(i)}))}var gn=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class vn extends os{constructor(t,e){super(),this.escClose=!1,this.outClose=!1,this.timeout=null!=e?e:300,this.openAct=D(".{prefix}-dialog-default-in",t),this.closeAct=D(".{prefix}-dialog-default-out",t),this.keyClose=""}}function _n(t){return ls({prefix:t,name:"dialog",create:(t,e,i,s)=>new wn(t,e,s,i)})}class wn extends ns{constructor(t,e,i,s){super("CuiDialogHandler",t,i,new vn(s,e.setup.animationTimeLong),e),this._bodyClass=D("{prefix}-dialog-open",s);const n=t.querySelector(D(".{prefix}-dialog-container",s));e.isPlugin("keys-plugin")||this.logWarning("KeyObserver plugin is not available, escClose and keyClose will not work"),this._busFacade=Zi(this.cuid,e.bus,t),this._keysPerformer=rn(this.closeOutside.bind(this)),this._freezeHelper=on(new es),this._keyComboParser=cn(),this._interactions=Qi(e.interactions);const r=Ot(e.interactions);this._windowClickPerformer=mn(this.closeOutside.bind(this),null!=n?n:void 0),this._openActionPerformer=vs(r,this._busFacade,{isActive:this.isActive.bind(this),onBefore:this.onBeforeOpen.bind(this),onAfter:this.onAfterOpen.bind(this)},{element:t,active:this.activeAction}),this._closeActionPerformer=_s(r,this._busFacade,{isActive:this.isActive.bind(this),onAfter:this.onAfterClose.bind(this)},{element:t,active:this.activeAction}),this.extend(ys(this._busFacade,{eventName:w.OPEN,performer:this._openActionPerformer})),this.extend(ys(this._busFacade,{eventName:w.CLOSE,performer:this._closeActionPerformer})),this.extend(ys(this._busFacade,{eventName:w.WINDOW_CLICK,performer:this._windowClickPerformer})),this.extend(new nn(t,this._busFacade,this._keysPerformer))}onHandle(){return gn(this,void 0,void 0,(function*(){return this._interactions.mutate(()=>{us.setAria(this.element,"aria-modal","")}),this.updateSetup(),!0}))}onRefresh(){return gn(this,void 0,void 0,(function*(){return this.updateSetup(),!0}))}onRemove(){return gn(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}updateSetup(){this._openActionPerformer.updateSetup({timeout:this.args.timeout,actions:Vt.get(this.args.openAct)}),this._closeActionPerformer.updateSetup({timeout:this.args.timeout,actions:Vt.get(this.args.closeAct)}),this._keysPerformer.setKeyCombos(an(this._keyComboParser,this.args.escClose,this.args.keyClose)),this._windowClickPerformer.setEnabled(this.args.outClose)}closeOutside(){this._closeActionPerformer.perform(null)}onBeforeOpen(){return!this.isAnyActive()&&(this._freezeHelper.getScroll(),!0)}onAfterOpen(){this._freezeHelper.freeze(),this.asyncClasses.setClasses(document.body,this._bodyClass)}onAfterClose(){this._freezeHelper.release(),this.asyncClasses.removeClasses(document.body,this._bodyClass)}onBeforeClose(){return!0}isAnyActive(){return this.classes.hasClass(this._bodyClass,document.body)}}class bn{constructor(t){this._target=t,this._inProgress=!1,this._isHovering=!1,this._isAttached=!1,this._callback=void 0,this._onMoveBound=this.onMouseMove.bind(this),this._onOutBound=this.onMouseOut.bind(this),this._onOverBound=this.onMouseOver.bind(this)}setCallback(t){this._callback=t}isInProgress(){return this._inProgress}attach(){this._target.addEventListener("mouseover",this._onOverBound),this._target.addEventListener("mousemove",this._onMoveBound),this._target.addEventListener("mouseout",this._onOutBound),this._isAttached=!0}detach(){this._target.removeEventListener("mouseover",this._onOverBound),this._target.removeEventListener("mousemove",this._onMoveBound),this._target.removeEventListener("mouseout",this._onOutBound),this._isAttached=!1}emit(t,e){S(this._callback)&&(!e&&this._inProgress||(this._inProgress=!0,window.requestAnimationFrame(this.invoke.bind(this,{isHovering:this._isHovering,event:t,timestamp:Date.now()}))))}isAttached(){return this._isAttached}invoke(t){this._callback&&this._callback(t),this._inProgress=!1}onMouseOver(t){this._isHovering=!0,this.emit(t,!0)}onMouseOut(t){this._isHovering=!1,this.emit(t,!0)}onMouseMove(t){this.emit(t,!1)}}class yn{constructor(){this._targetHeight=-1,this._targetWidth=-1,this._box=void 0,this._margin=0}setElementBox(t){this._box=t}setTarget(t){this._targetWidth=t.width,this._targetHeight=t.height}setMargin(t){this._margin=t}getVerticalPosition(t){switch(t){case"top":return this.getTopPosition();case"bottom":return this.getBottomPosition();case"middle":return this.getMiddlePosition();default:return-1}}getHorizontalPosition(t){switch(t){case"left":return this.getLeftPosition();case"right":return this.getRightPosition();case"center":return this.getCenterPosition();default:return-1}}getAutoVerticalPosition(t){let e=window.innerHeight,i=this.getVerticalPosition(t);return("top"===t||"middle"===t)&&i<0?[this.getVerticalPosition("bottom"),"bottom"]:("bottom"===t||"middle"===t)&&i+this._targetHeight>e?[this.getVerticalPosition("top"),"top"]:[i,t]}getAutoHorizontalPosition(t){let e=window.innerWidth,i=this.getHorizontalPosition(t);return("right"===t||"center"===t)&&i<0?[this.getHorizontalPosition("left"),"left"]:("left"===t||"center"===t)&&i+this._targetWidth>e?[this.getHorizontalPosition("right"),"right"]:[i,t]}getTopPosition(){return this.throwIfNotValid("getTopPosition"),this._box.top-this._margin-this._targetHeight}getBottomPosition(){return this.throwIfNotValid("getBottomPosition"),this._box.top+this._box.height+this._margin}getMiddlePosition(){return this.throwIfNotValid("getMiddlePosition"),this._box.top+this._box.height/2-this._targetHeight/2}getLeftPosition(){return this.throwIfNotValid("getLeftPosition"),this._box.left}getRightPosition(){return this.throwIfNotValid("getRightPosition"),this._box.left+this._box.width-this._targetWidth}getCenterPosition(){return this.throwIfNotValid("getCenterPosition"),this._box.left+this._box.width/2-this._targetWidth/2}validate(){return x(this._box)&&this._targetHeight>0&&this._targetWidth>0}throwIfNotValid(t){if(!this.validate())throw new l(`[${t}] Position cannot be calculated: missing data [width: ${this._targetWidth}][height: ${this._targetHeight}]`)}}class xn{constructor(t){this._preferred="top-center",this._static="",this._evaluator=null!=t?t:new yn,this._log=et.get("CuiBasePositionCalculator")}setMargin(t){this._evaluator.setMargin(t)}setPreferred(t){this._preferred=t}setStatic(t){this._static=t}calculate(t,e){if(this._evaluator.setElementBox(t),this._evaluator.setTarget(e),x(this._static)){this._log.debug("Evaluating static position");const[t,e]=this.parse(this._static);return[this._evaluator.getHorizontalPosition(e),this._evaluator.getVerticalPosition(t),this._static]}let[i,s]=["",""];x(this._preferred)&&(this._log.debug("Evaluating auto position"),[i,s]=this.parse(this._preferred)),i=null!=i?i:"top",s=null!=s?s:"center",this._log.debug("Calculating position: "+i+"-"+s);const[n,r]=this._evaluator.getAutoVerticalPosition(i),[o,a]=this._evaluator.getAutoHorizontalPosition(s);return this._log.debug("Calculated position: "+r+"-"+a),[o,n,r+"-"+a]}parse(t){return t.split("-")}}class Cn{constructor(t,e,i){this._autoRenew=e,this._timeout=t,this._callback=i}start(){this.canRun()&&(this.stop(),this._taskId=setTimeout(()=>{this._callback(),this._taskId=null,this._autoRenew&&this.start()},this._timeout))}stop(){this._taskId&&(clearTimeout(this._taskId),this._taskId=null)}getId(){return this._taskId}canRun(){return x(this._callback)&&this._timeout>0}setCallback(t){this._callback=t}setTimeout(t){this._timeout=t}}var An=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class kn{constructor(t,e){this.type="hover",this.description="",this._onHover=e,this._hoverListener=new bn(t),this._hoverListener.setCallback(this.onHover.bind(this))}init(t){return An(this,void 0,void 0,(function*(){return this._hoverListener.attach(),!0}))}destroy(){return An(this,void 0,void 0,(function*(){return this._hoverListener.detach(),!0}))}onHover(t){this._onHover(t)}}var En=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Tn extends os{constructor(t){super({props:{trigger:{corrector:j}}}),this.mode="click",this.trigger=j("> a, button"),this.autoClose=!1,this.outClose=!0,this.prevent=!1,this.pos="",this.action=D("{prefix}-drop-animation-in",t),this.timeout=3e3,this.margin=8}}function Sn(t){return ls({prefix:t,name:"drop",create:(t,e,i,s)=>new Pn(t,e,s,i)})}class Pn extends ns{constructor(t,e,i,s){super("CuiDropHandler",t,i,new Tn(s),e),this._prefix=s,this._bodyClass=D("{prefix}-drop-open",s),this.onTriggerClick=this.onTriggerClick.bind(this),this._positionCalculator=new xn,this._positionCalculator.setMargin(8),this._positionCalculator.setPreferred("bottom-left"),this._posClass="",this._triggerHoverListener=void 0,this._trigger=this.element,this._actions=[],this._autoTask=new Cn(this.args.timeout,!1,this.close.bind(this)),this._windowClickPerformer=mn(this.close.bind(this),t),this._busFacade=Zi(this.cuid,e.bus,t),this._interactions=Qi(e.interactions),e.isPlugin("click-plugin")||this.logWarning("Window click plugin is not available: outClose will not work"),this.extend(new kn(this.element,this.onElementHover.bind(this))),this.extend(ys(this._busFacade,{eventName:w.WINDOW_CLICK,performer:this._windowClickPerformer})),this.extend(ys(this._busFacade,{eventName:w.OPEN,performer:ms(this.open.bind(this))})),this.extend(ys(this._busFacade,{eventName:w.CLOSE,performer:ms(this.close.bind(this))}))}onHandle(){return En(this,void 0,void 0,(function*(){return this._trigger=this.acquireTrigger(),this._triggerHoverListener=new bn(this._trigger),this._triggerHoverListener.setCallback(this.onHoverEvent.bind(this)),this._triggerHoverListener.attach(),this._trigger.addEventListener("click",this.onTriggerClick),this.setDataFromArgs(),this._interactions.mutate(()=>{us.setAria(this.element,"aria-dropdown","")}),!0}))}onRefresh(){return En(this,void 0,void 0,(function*(){return this.prevArgs&&this.args.trigger!==this.prevArgs.trigger&&(this._triggerHoverListener&&this._triggerHoverListener.isAttached()?this._triggerHoverListener.detach():this.prevArgs&&"click"===this.prevArgs.mode&&this._trigger.removeEventListener("click",this.onTriggerClick),this._trigger=this.acquireTrigger(),this._triggerHoverListener=new bn(this._trigger),this._triggerHoverListener.setCallback(this.onHoverEvent.bind(this)),this._triggerHoverListener.attach(),this._trigger.addEventListener("click",this.onTriggerClick)),this.setDataFromArgs(),!0}))}onRemove(){return En(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}setDataFromArgs(){this._positionCalculator.setStatic(this.args.pos),this._positionCalculator.setMargin(this.args.margin),this._autoTask.setTimeout(this.args.timeout),this._actions=Vt.get(this.args.action),this._windowClickPerformer.setEnabled(this.args.outClose)}open(){return En(this,void 0,void 0,(function*(){return this.isActive()?this.close():(this.isAnyActive()&&(yield this.findAndCloseOpenedDrop()),!!this.lock("open")&&(this.log.debug("Drop "+this.cuid,"open"),this.onOpen(),!0))}))}close(){return En(this,void 0,void 0,(function*(){return!!this.isActive()&&(!!this.lock("close")&&(this.logInfo("Drop "+this.cuid,"close"),this.onClose(),this._busFacade.emit(w.CLOSED,{timestamp:Date.now()}),!0))}))}onOpen(){this.classes.setClass(this.activeClassName,this.element),this._interactions.mutate(()=>{const t=this._trigger.getBoundingClientRect();try{const[e,i,s]=this._positionCalculator.calculate(t,this.element.getBoundingClientRect());this.element.style.top=i-t.top+"px",this.element.style.left=e-t.left+"px",this._posClass=D("{prefix}-drop-position-"+s,this._prefix),this.toggleActions(),this.classes.setClass(this._posClass,this.element),this.classes.setClass(this._bodyClass,document.body),us.setAria(this.element,"aria-expanded","true")}catch(t){this.log.exception(t)}finally{this.unlock(),this._busFacade.emit(w.OPENED,{timestamp:Date.now()}),this.runAutoCloseTask()}})}onClose(){this._interactions.mutate(()=>{this.classes.removeClass(this.activeClassName,this.element),this.classes.removeClass(this._bodyClass,document.body),this.toggleActions(),this.classes.removeClass(this._posClass,this.element),us.setAria(this.element,"aria-expanded","false"),this.unlock()})}isAnyActive(){return this.classes.hasClass(this._bodyClass,document.body)}findAndCloseOpenedDrop(){return En(this,void 0,void 0,(function*(){const t=document.querySelector(`[${this.attribute}].${this.activeClassName}`);if(!x(t))return this.log.warning("Opened drop was not found"),!1;const e=t.$handlers[this.attribute];return x(e)?e.close():(this.log.warning("Drop handler was not found in the element"),!1)}))}onTriggerClick(t){"click"===this.args.mode&&(this.isActive()?this.close():this.open())}onHoverEvent(t){"hover"===this.args.mode&&t.isHovering&&!this.isActive()&&this.open()}onElementHover(t){t.isHovering?this._autoTask.stop():!t.isHovering&&this.args.autoClose&&this.runAutoCloseTask()}runAutoCloseTask(){this.args.autoClose&&this._autoTask.start()}toggleActions(){this._actions.forEach(t=>{t.toggle(this.element)})}acquireTrigger(){let t=null;return t=this.element.parentElement?this.element.parentElement.querySelector(this.args.trigger):document.querySelector(this.args.trigger),null!=t?t:this.element}}var Ln,In=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},On=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Mn{calculate(t,e,i,s){return[t,e]}}new WeakMap;class Nn{constructor(t){Ln.set(this,void 0),In(this,Ln,t)}calculate(t,e,i,s){return[t-On(this,Ln).offsetLeft,e-On(this,Ln).offsetTop]}}Ln=new WeakMap;function Hn(t,e,i,s,n){const r=Fn[t];if(r)return function(t,e,i){return{init:t=>{t.event.preventDefault()},move:(s,n,r,o)=>{const[a,h]=t.calculate(s,n,r,o);var c,l,u,d;c=h,l=a,u=e.offsetWidth,d=e.offsetHeight,c+d<window.innerHeight-10&&c>10&&l>10&&l+u<window.innerWidth-10&&i(a,h,e)}}}(e,i,r(s,n))}new WeakMap;const Fn={resize:function(t,e){return(i,s,n)=>{t.mutate(()=>{e.setStyle("width",i+"px",n),e.setStyle("height",s+"px",n)})}},move:function(t,e){return(i,s,n)=>{t.mutate(()=>{e.setStyle("left",i+"px",n),e.setStyle("top",s+"px",n)})}}};var Wn=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};function Dn(t){return{type:t.type,init:()=>Wn(this,void 0,void 0,(function*(){return t.listener.isAttached()||t.listener.attach(),!0})),destroy:()=>Wn(this,void 0,void 0,(function*(){return t.listener.isAttached()&&t.listener.detach(),!0}))}}function Rn(t){const e=new ti(t.root);return e.setTarget(t.target),e.preventDefault(!0===t.preventDefault),e.setCallback(e=>{t.performer.perform(e)}),Dn({type:"move",listener:e})}var Bn=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class $n extends os{constructor(t,e){super(),this.escClose=!1,this.keyClose="",this.openAct=D(".{prefix}-float-default-in",t),this.closeAct=D(".{prefix}-float-default-out",t),this.timeout=null!=e?e:300}}function zn(t){return ls({prefix:t,name:"float",create:(t,e,i,s)=>new Vn(t,e,s,i)})}class Vn extends ns{constructor(t,e,i,s){super("CuiFloatHandler",t,i,new $n(s,e.setup.animationTime),e),this._prevX=0,this._prevY=0,this._positionCalculator=new Mn,this._resizeCalculator=new Nn(t),this._prefix=s,this._moveBtn=null,this._resizeBtn=null,this._currentAction=void 0,this._interactions=Qi(e.interactions),this._styles=new es,this._busFacade=Zi(this.getId(),e.bus,t),this._keysPerformer=rn(this.onCloseAction.bind(this)),this._keyComboParser=cn(),this._movePerformer=fs({onDown:this.onMouseDown.bind(this),onMove:this.onMouseMove.bind(this),onUp:this.onMouseUp.bind(this)}),this._movePerformer.setEnabled(!1);const n=Ot(e.interactions);this._openActionPerformer=vs(n,this._busFacade,{isActive:this.isActive.bind(this),onFinish:()=>{this._movePerformer.setEnabled(!0)}},{active:this.activeAction,element:t}),this._closeActionPerformer=_s(n,this._busFacade,{isActive:this.isActive.bind(this),onFinish:()=>{this._movePerformer.setEnabled(!1)}},{active:this.activeAction,element:t}),e.isPlugin("keys-plugin")||this.logWarning("KeyObserver plugin is not available, escClose and keyClose will not work"),this.extend(Rn({performer:this._movePerformer})),this.extend(ys(this._busFacade,{eventName:w.OPEN,performer:this._openActionPerformer})),this.extend(ys(this._busFacade,{eventName:w.CLOSE,performer:this._closeActionPerformer})),this.extend(new nn(t,this._busFacade,this._keysPerformer))}onHandle(){return Bn(this,void 0,void 0,(function*(){return us.setAria(this.element,"aria-modal",""),this._moveBtn=this.element.querySelector(D(".{prefix}-float-move",this._prefix)),this._resizeBtn=this.element.querySelector(D(".{prefix}-float-resize",this._prefix)),this.updateSetups(),!0}))}onRefresh(){return Bn(this,void 0,void 0,(function*(){return this.updateSetups(),!0}))}onRemove(){return Bn(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}updateSetups(){this._closeActionPerformer.updateSetup({timeout:this.args.timeout,actions:Vt.get(this.args.closeAct)}),this._openActionPerformer.updateSetup({timeout:this.args.timeout,actions:Vt.get(this.args.openAct)}),this._keysPerformer.setKeyCombos(an(this._keyComboParser,this.args.escClose,this.args.keyClose))}onMouseDown(t){let e="",i=void 0;if(t.target===this._moveBtn)e="move",i=this._positionCalculator;else{if(t.target!==this._resizeBtn)return;e="resize",i=this._resizeCalculator}this._currentAction=Hn(e,i,this.element,this._interactions,this._styles),this._currentAction&&this._currentAction.init(t),this._prevX=t.x,this._prevY=t.y,this.asyncClasses.setClasses(document.body,p),this.core.bus.emit(w.MOVE_LOCK,null,!0)}onMouseMove(t){this._currentAction&&this._currentAction.move(t.x,t.y,t.x-this._prevX,t.y-this._prevY),this._prevX=t.x,this._prevY=t.y,t.event.preventDefault()}onMouseUp(t){this._currentAction=void 0,this.asyncClasses.removeClasses(document.body,p),this.core.bus.emit(w.MOVE_LOCK,null,!1)}onCloseAction(){this._closeActionPerformer.perform("keys")}}var qn=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Un extends os{constructor(){super({main:"icon"}),this.icon="",this.scale=1}}function jn(t){return ls({name:"icon",prefix:t,create:(t,e,i,s)=>new Kn(t,e,s)})}class Kn extends ns{constructor(t,e,i){super("CuiIconHandler",t,i,new Un,e),this._interactions=Qi(e.interactions,this)}onHandle(){return qn(this,void 0,void 0,(function*(){return this.addIcon(this.args.icon),!0}))}onRefresh(){return qn(this,void 0,void 0,(function*(){return!(!this.prevArgs||this.args.icon===this.prevArgs.icon)&&(this.addIcon(this.args.icon),!0)}))}onRemove(){return qn(this,void 0,void 0,(function*(){const t=this.element.querySelectorAll("svg");return x(t)&&t.remove(),!0}))}addIcon(t){const e=t?g[t]:null;if(!e)return;const i=new ui(e).setScale(this.args.scale).build();if(!i)return;const s=this.element.querySelectorAll("svg");this._interactions.mutate(()=>{for(let t of s)t.remove();this.element.childNodes.length>0?this.insertBefore(i):this.appendChild(i)})}insertBefore(t){this.element.insertBefore(t,this.element.firstChild)}appendChild(t){this.element.appendChild(t)}}var Gn,Yn=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))},Xn=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},Zn=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Qn extends os{constructor(t,e){super(),Gn.set(this,void 0),Xn(this,Gn,t),this.escClose=!1,this.position="right",this.openAct=this.getDefaultOpenClass(),this.closeAct=this.getDefaultCloseClass(),this.timeout=null!=e?e:300,this.outClose=!1,this.keyClose=""}getDefaultOpenClass(){return D("right"===this.position?".{prefix}-offcanvas-default-right-in":".{prefix}-offcanvas-default-left-in",Zn(this,Gn))}getDefaultCloseClass(){return D("right"===this.position?".{prefix}-offcanvas-default-right-out":".{prefix}-offcanvas-default-left-out",Zn(this,Gn))}}function Jn(t){return ls({prefix:t,name:"off-canvas",create:(t,e,i,s)=>new tr(t,e,s,i)})}Gn=new WeakMap;class tr extends ns{constructor(t,e,i,s){super("CuiOffCanvasHandler",t,i,new Qn(s,e.setup.animationTime),e),this._prefix=s;const n=t.querySelector(D(".{prefix}-off-canvas-container",s));this._bodyClass=D("{prefix}-off-canvas-open",s),this._busFacade=Zi(this.cuid,e.bus,t),this._keysPerformer=rn(this.closeOutside.bind(this)),this._freezeHelper=on(new es),this._keyComboParser=cn();const r=Ot(e.interactions);this._windowClickPerformer=mn(this.closeOutside.bind(this),null!=n?n:void 0),this._interactions=Qi(e.interactions,this),e.isPlugin("click-plugin")||this.logWarning("WindowClick plugin is not available, outClose will not work"),e.isPlugin("keys-plugin")||this.logWarning("KeyObserver plugin is not available, escClose and keyClose will not work"),this._openActionPerformer=vs(r,this._busFacade,{isActive:this.isActive.bind(this),onBefore:this.onBeforeOpen.bind(this),onAfter:this.onAfterOpen.bind(this)},{element:t,active:this.activeAction}),this._closeActionPerformer=_s(r,this._busFacade,{isActive:this.isActive.bind(this),onAfter:this.onAfterClose.bind(this)},{element:t,active:this.activeAction}),this.extend(ys(this._busFacade,{eventName:w.OPEN,performer:this._openActionPerformer})),this.extend(ys(this._busFacade,{eventName:w.CLOSE,performer:this._closeActionPerformer})),this.extend(ys(this._busFacade,{eventName:w.WINDOW_CLICK,performer:this._windowClickPerformer})),this.extend(new nn(t,this._busFacade,this._keysPerformer))}onHandle(){return Yn(this,void 0,void 0,(function*(){return this._interactions.mutate(()=>{this.setPositionLeft(),us.setAria(this.element,"aria-modal","")}),this.updateSetup(),!0}))}onRefresh(){return Yn(this,void 0,void 0,(function*(){return this.updateSetup(),!0}))}onRemove(){return Yn(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}updateSetup(){this._openActionPerformer.updateSetup({timeout:this.args.timeout,actions:Vt.get(this.args.openAct)}),this._closeActionPerformer.updateSetup({timeout:this.args.timeout,actions:Vt.get(this.args.closeAct)}),this._keysPerformer.setKeyCombos(an(this._keyComboParser,this.args.escClose,this.args.keyClose)),this._windowClickPerformer.setEnabled(this.args.outClose)}closeOutside(){this._closeActionPerformer.perform(null)}onBeforeOpen(){return!this.isAnyActive()&&(this._freezeHelper.getScroll(),!0)}onAfterOpen(){this._freezeHelper.freeze(),this.asyncClasses.setClasses(document.body,this._bodyClass)}onAfterClose(){this._freezeHelper.release(),this.asyncClasses.removeClasses(document.body,this._bodyClass)}onBeforeClose(){return!0}isAnyActive(){return this.classes.hasClass(this._bodyClass,document.body)}setPositionLeft(){let t=C(this._prefix,"left");"left"!==this.args.position||this.classes.hasClass(t,this.element)?"right"==this.args.position&&this.classes.hasClass(t,this.element)&&this.classes.removeClass(t,this.element):this.classes.setClass(t,this.element)}}var er,ir,sr,nr,rr,or,ar,hr=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},cr=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class lr{matches(t,e,i,s){return i>0&&e>=i||s>0&&t>=s}}class ur{constructor(){er.set(this,void 0),ir.set(this,void 0),sr.set(this,void 0),nr.set(this,void 0),rr.set(this,void 0),or.set(this,void 0),ar.set(this,void 0),hr(this,er,0),hr(this,ir,0),hr(this,nr,0),hr(this,sr,0),hr(this,ar,100),hr(this,rr,!1),hr(this,or,!1)}matches(t,e,i,s){return this.fitsOffsetY(t,s)||this.fitsOffsetX(e,i)}fitsOffsetX(t,e){if(e<=0)return!1;let i=t-cr(this,er);return t>=e&&i>cr(this,ar)?hr(this,rr,!0):cr(this,rr)&&i<-cr(this,ar)&&hr(this,rr,!1),(i<0&&cr(this,nr)<i||i>=0&&cr(this,nr)>i)&&hr(this,er,t),hr(this,nr,i),cr(this,rr)}fitsOffsetY(t,e){if(e<=0)return!1;let i=t-cr(this,ir);return t>=e&&i>cr(this,ar)?hr(this,or,!0):cr(this,or)&&i<-cr(this,ar)&&hr(this,or,!1),(i<0&&cr(this,sr)<i||i>=0&&cr(this,sr)>i)&&hr(this,ir,t),hr(this,sr,i),cr(this,or)}}er=new WeakMap,ir=new WeakMap,sr=new WeakMap,nr=new WeakMap,rr=new WeakMap,or=new WeakMap,ar=new WeakMap;class dr{static get(t){return"dynamic"===t?new ur:new lr}}class fr{static get(t){return t instanceof Window?new gr:t instanceof HTMLElement?new mr(t):new pr(t)}}class pr{constructor(t){this._element=t,this._box=t.getBoundingClientRect()}getHeight(){return this._box.height}getWidth(){return this._box.width}getTop(){return this._box.top}getLeft(){return this._box.left}getScrollHeight(){return this._element.scrollHeight}getScrollWidth(){return this._element.scrollWidth}getScrollTop(){return this._element.scrollTop}getScrollLeft(){return this._element.scrollLeft}queryAll(t){return[...this._element.querySelectorAll(t)]}get(){return this._element}scrollTo(t){this._element.scrollTo(t)}}class mr{constructor(t){this._element=t}getHeight(){return this._element.offsetHeight}getWidth(){return this._element.offsetWidth}getTop(){return this._element.offsetTop}getLeft(){return this._element.offsetLeft}getScrollHeight(){return this._element.scrollHeight}getScrollWidth(){return this._element.scrollWidth}getScrollTop(){return this._element.scrollTop}getScrollLeft(){return this._element.scrollLeft}queryAll(t){return[...this._element.querySelectorAll(t)]}get(){return this._element}scrollTo(t){this._element.scrollTo(t)}}class gr{getHeight(){return window.innerHeight}getWidth(){return window.innerWidth}getTop(){return 0}getLeft(){return 0}getScrollHeight(){return window.innerHeight}getScrollWidth(){return window.innerWidth}getScrollTop(){return window.pageYOffset}getScrollLeft(){return window.pageXOffset}queryAll(t){return[...document.querySelectorAll(t)]}get(){return window}scrollTo(t){window.scrollTo(t)}}class vr{constructor(t,e){this._target=t,this._box=fr.get(t),this._inProgress=!1,this._threshold=E(e,0,100,0),this._prevX=this._prevY=0,this._isAttached=!1,this._callback=void 0,this._task=new Cn(50,!1,this.onScrollFinish.bind(this)),this._listener=this.listener.bind(this)}setCallback(t){this._callback=t}attach(){this._target.addEventListener("scroll",this._listener),this._isAttached=!0,this.listener(void 0,!0,"init")}detach(){this._target.removeEventListener("scroll",this._listener),this._task.stop(),this._isAttached=!1}setTarget(t){t!==this._target&&(this.detach(),this._target=t,this.attach())}setThreshold(t){this._threshold=E(t,0,100,0)}isInProgress(){return this._inProgress}isAttached(){return this._isAttached}listener(t,e,i){if(!x(this._callback))return;let s=this._box.getScrollLeft(),n=this._box.getScrollTop();this._prevX+=s,this._prevY+=n,this._inProgress||!this.passedThreshold()&&x(t)||(this._inProgress=!0,this._callback({base:t,top:n,left:s,initial:null!=e&&e,scrolling:x(t),source:null!=i?i:"event"}),x(t)&&this._task.start(),this._inProgress=!1,this._prevX=0,this._prevY=0)}passedThreshold(){return this._threshold<=0||this._prevX>=this._threshold||this._prevY>=this._threshold}onScrollFinish(){this.listener(void 0,!1,"task")}}function _r(t){var e;const i=new vr(t.element,t.threshold);return i.setCallback((function(e){t.performer.perform(e)})),Dn({listener:i,type:null!==(e=t.type)&&void 0!==e?e:"scroll"})}function wr(t){return{perform:e=>{t.callback(e)}}}function br(t){let e=[],i=fr.get(t.element);function s(s){x(e)&&t.callback(function(t){var s,n;let r=t.top+i.getHeight(),o=t.left+i.getWidth();return{ev:t.base,top:t.top,left:t.left,scrolling:null!==(s=t.scrolling)&&void 0!==s&&s,initial:null!==(n=t.initial)&&void 0!==n&&n,source:t.source,items:e.map((e,i)=>({verticalRatio:function(t,e,i){let s=t.offsetTop+t.offsetHeight,n=e>t.offsetTop?e:t.offsetTop;return k(((i<s?i:s)-n)/t.offsetHeight,0,1)}(e,t.top,r),horizontalRatio:function(t,e,i){let s=t.offsetLeft+t.offsetWidth,n=e>t.offsetLeft?e:t.offsetLeft;return k(((i<s?i:s)-n)/t.offsetWidth,0,1)}(e,t.left,o),element:e}))}}(s))}return Object.assign(Object.assign({},wr({callback:s})),{setChildren:t=>{e=t},callInitialEvent:()=>{s({base:void 0,initial:!0,scrolling:!1,left:i.getScrollLeft(),top:i.getScrollTop(),source:"performer"})}})}function yr(t){let e=0,i=0;return wr({callback:function(s){if(n=s.left,r=s.top,Math.abs(n-e)>t.threshold||Math.abs(r-i)>t.threshold)return t.callback(s),e=s.left,void(i=s.top);var n,r}})}var xr=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Cr extends os{constructor(){super(),this.offsetX=-1,this.offsetY=-1,this.target="",this.action="",this.mode="static"}}function Ar(t){return ls({prefix:t,name:"offset",create:(t,e,i,s)=>new kr(t,e,s)})}class kr extends ns{constructor(t,e,i){super("CuiOffsetHandler",t,i,new Cr,e),this._targets=[this.element],this._matched=!1,this._actions=[],this._modeHandler=dr.get(this.args.mode),this._busFacade=Zi(this.cuid,e.bus,t),this._interactions=Qi(e.interactions);const s=this.element.hasAttribute(m)?window:t;this._root=fr.get(s),this._performer=yr({callback:this.checkAndPerformActions.bind(this),threshold:20}),this.extend(_r({element:s,threshold:5,performer:this._performer}))}onHandle(){return xr(this,void 0,void 0,(function*(){return this.parseAttribute(),this._performer.perform({base:void 0,initial:!0,left:this._root.getScrollLeft(),top:this._root.getScrollTop(),scrolling:!1,source:"CuiOffsetHandler"}),!0}))}onRefresh(){return xr(this,void 0,void 0,(function*(){return this.parseAttribute(),!0}))}onRemove(){return xr(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}parseAttribute(){this._targets=this.getTargets(),this._actions=Vt.get(this.args.action),this._modeHandler=dr.get(this.args.mode)}checkAndPerformActions(t){let e=this._modeHandler.matches(t.top,t.left,this.args.offsetX,this.args.offsetY);e!==this._matched&&(this.act(e),this._matched=e),this.callEvent(this._matched,t.left,t.top,t.scrolling,t.source,...this.calcaRatio(t.left,t.top))}act(t){S(this._actions,this._targets)&&this._interactions.mutate(()=>{this._actions.forEach(e=>{this.actForTargets(t?e.add.bind(e):e.remove.bind(e))})})}actForTargets(t){this._targets.forEach(e=>t(e))}callEvent(t,e,i,s,n,r,o){this._busFacade.emit(w.OFFSET,{matches:this._matched,offsetX:e,offsetY:i,ratioX:r,ratioY:o,scrolling:s,source:n,timestamp:Date.now()})}calcaRatio(t,e){let i=parseFloat(((this._root.getHeight()+e)/this._root.getScrollHeight()).toFixed(2));return[k(parseFloat(((this._root.getWidth()+t)/this._root.getScrollWidth()).toFixed(2)),0,1),k(i,0,1)]}getTargets(){return this.args.target?this._root.queryAll(this.args.target):[this.element]}}var Er=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Tr extends os{constructor(t){super({main:"target"}),this.target="",this.action="",this.timeout=null!=t?t:300,this.prevent=!1,this.stopPropagation=!1,this.state=""}}function Sr(t){return ls({name:"open",prefix:t,create:(t,e,i,s)=>new Pr(t,e,s)})}class Pr extends ns{constructor(t,e,i){super("CuiOpenHandler",t,i,new Tr(e.setup.animationTime),e),this._busFacade=Zi(this.cuid,e.bus,t),this._actionsHelper=new Mt(e.interactions),this.extend(cs({element:t,performer:ms(this.onOpen.bind(this))})),this.extend(ys(this._busFacade,{eventName:w.OPEN,type:"open",performer:ms(this.onOpen.bind(this))}))}onHandle(){return Er(this,void 0,void 0,(function*(){return!0}))}onRefresh(){return Er(this,void 0,void 0,(function*(){return!0}))}onRemove(){return Er(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}onOpen(t){if(!this.lock())return;const e=this.getTarget();x(e)?this.run(e).then(e=>{e&&this.emitOpen(t)}).catch(t=>{this.log.exception(t)}).finally(()=>{this.unlock()}):this.log.warning(`Target ${this.args.target} not found`,"onClick")}run(t){return Er(this,void 0,void 0,(function*(){console.log(t);let e=t.$cuid;if(x(e))return this.handleClickCui(e),!1;if(this.log.debug("Open html component"),S(this.args.timeout,this.args.action)){this.log.debug("Perfrom an action");let e=Vt.get(this.args.action);return this._actionsHelper.performActions(t,e,this.args.timeout,()=>{this.classes.setClass(this.activeClassName,t)})}return this.asyncClasses.setClasses(t,this.activeClassName),!0}))}handleClickCui(t){return this.log.debug("Open cUI component"),this.core.bus.emit(w.OPEN,t,this.args.state),!1}emitOpen(t){this._busFacade.emit(w.OPENED,{event:t,state:this.args.state})}getTarget(){var t;return x(this.args.target)&&null!==(t=document.querySelector(this.args.target))&&void 0!==t?t:B(this.element)}}var Lr,Ir=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},Or=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class Mr{constructor(t,e){Lr.set(this,void 0),this.name=t,Ir(this,Lr,[]),z(e,(t,e)=>{let i=Rs.get(t);i&&(i.setProperty(e),Or(this,Lr).push(i))})}perform(t,e){0!==Or(this,Lr).length&&Or(this,Lr).forEach(i=>i.perform(t,e,1))}}Lr=new WeakMap;var Nr=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Hr{constructor(t,e,i){this.type="mutations",this.description="",this._element=t,this._performer=e,this._disabled=!0,this._isObserving=!1,this._options=null!=i?i:{childList:!0,subtree:!0},this._observer=new MutationObserver(this.onMutation.bind(this))}init(t){return Nr(this,void 0,void 0,(function*(){return this.observe(),!0}))}destroy(){return Nr(this,void 0,void 0,(function*(){return this.unobserve(),!0}))}observe(){this._isObserving||this._disabled||(this._observer.observe(this._element,this._options),this._isObserving=!0)}unobserve(){this._isObserving&&(this._observer.disconnect(),this._isObserving=!1)}disable(t){this._disabled=t,this._disabled&&this.unobserve()}onMutation(t){this._performer.perform(t)}}function Fr(t){let e=null;const i=t;function s(t){return null!==t.find(t=>t.matches(e))}function n(t){return t.reduce((t,i)=>(e&&"childList"===i.type?function(t){return t.addedNodes.length>0?s([...t.addedNodes]):t.removedNodes.length>0&&s([...t.removedNodes])}(i)&&t.push(i):t.push(i),t),[])}return{perform:t=>{let s=t;e&&(s=n(t)),s.length>0&&i(s)},setSelector:t=>{e=t}}}var Wr=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Dr extends os{constructor(){super({props:{targets:{corrector:j}}}),this.targets=j("> *"),this.startRatio=0,this.stopRatio=1,this.animation=""}}function Rr(t){return ls({prefix:t,name:"parallax",create:(t,e,i,s)=>new Br(t,e,s)})}class Br extends ns{constructor(t,e,i){super("CuiParallaxHandler",t,i,new Dr,e),this._defaultAnimator=void 0,this._targetSetup=[],this._interactions=Qi(e.interactions);const s=t.hasAttribute(m)?window:t;this._styles=new es,this._intersectionPerformer=br({element:s,callback:this.onIntersection.bind(this)}),this._mutationPerformer=Fr(this.onMutation.bind(this)),this.extend(_r({element:s,performer:this._intersectionPerformer,threshold:5})),this.extend(new Hr(t,this._mutationPerformer))}onHandle(){return Wr(this,void 0,void 0,(function*(){return this.updateArguments(),this._intersectionPerformer.callInitialEvent(),!0}))}onRefresh(){return Wr(this,void 0,void 0,(function*(){return this.prevArgs&&this.prevArgs.targets!==this.args.targets&&(this.clean(),this.updateArguments()),!0}))}onRemove(){return Wr(this,void 0,void 0,(function*(){return this.clean(),!0}))}updateArguments(){this._mutationPerformer.setSelector(this.args.targets),this._defaultAnimator=new Mr(this.args.animation,this.core.setup.parallaxAnimations[this.args.animation]),this._targetSetup=this.getTargets(),this._intersectionPerformer.setChildren(this._targetSetup.map(t=>t.element))}onIntersection(t){this._interactions.mutate(()=>{t.items.forEach((t,e)=>{if(e>=this._targetSetup.length)return;const i=this._targetSetup[e];i.animator&&i.animator.perform(t.element,function(t,e,i){let s=i-t;s<0&&(s=0);let n=s/(e-t);return Math.min(n,1)}(i.start,i.stop,t.verticalRatio))})})}onMutation(t){this._targetSetup=this.getTargets(),this._intersectionPerformer.setChildren(this._targetSetup.map(t=>t.element))}getTargets(){const t=[];return this.element.querySelectorAll(this.args.targets).forEach(e=>{var i;t.push({element:e,animator:null!==(i=this.getTargetAnimator(e))&&void 0!==i?i:this._defaultAnimator,start:M(e.getAttribute("data-parallax-start-ratio"),this.args.startRatio),stop:M(e.getAttribute("data-parallax-stop-ratio"),this.args.stopRatio)})}),t}getTargetAnimator(t){if(!t.hasAttribute("data-parallax-animation"))return;const e=t.getAttribute("data-parallax-animation");let i=this.core.setup.parallaxAnimations[e];return i?new Mr(e,i):void 0}clean(){this._targetSetup.forEach(t=>{this.core.interactions.mutate(this._styles.clean,null,t.element)})}}class $r{constructor(t,e){this._root=t,this._threshold=null!=e?e:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],this._callback=void 0,this._observer=void 0}setCallback(t){this._callback=t}connect(){this._callback&&(this._observer=new IntersectionObserver(this._callback,{root:this._root,rootMargin:"0px",threshold:this._threshold}))}observe(t){this._observer&&this._observer.observe(t)}unobserve(t){this._observer&&this._observer.unobserve(t)}disconnect(){this._observer&&this._observer.disconnect()}}var zr=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};const Vr=[{key:"none",value:t=>t.default},{key:"small",value:t=>t.small},{key:"medium",value:t=>t.medium},{key:"large",value:t=>t.large},{key:"xlarge",value:t=>t.xlarge}];class qr{constructor(t){this._replace=!0===t}get(t,e){let i=t[e];return this._replace&&!i?t.default:null!=i?i:""}}class Ur{constructor(){this._steps=Vr}get(t,e){var i;let s=t.default;for(let n of this._steps)if(s=null!==(i=n.value(t))&&void 0!==i?i:s,e===n.key)return s;return s}}function jr(t){return"smart"===t?new Ur:new qr}var Kr=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Gr extends os{constructor(){super(),this.mode="simple",this.default="",this.small=this.medium=this.large=this.xlarge="",this.delay=1}}function Yr(t){return ls({prefix:t,name:"resize",create:(t,e,i,s)=>new Xr(t,e,s)})}class Xr extends ns{constructor(t,e,i){super("CuiResizeHandler",t,i,new Gr,e),this._busFacade=Zi(this.cuid,e.bus,t),this._lastValue="",this._currentValue="",this._isIntersecting=!1,this._currentAction=void 0,this._interactions=Qi(e.interactions),this._resizeValueCalculator=jr(this.args.mode),this._task=new Cn(this.args.delay,!1,this.updateAction.bind(this));const s=new $r(document.documentElement,[0,.1]);s.setCallback(this.onIntersection.bind(this)),this.extend(function(t){var e;return{type:null!==(e=t.type)&&void 0!==e?e:"observer",init:()=>zr(this,void 0,void 0,(function*(){return t.observer.connect(),t.observer.observe(t.element),!0})),destroy:()=>zr(this,void 0,void 0,(function*(){return t.observer.unobserve(t.element),t.observer.disconnect(),!0}))}}({type:"intersection",element:t,observer:s})),this.extend(ys(this._busFacade,{eventName:w.RESIZE,performer:ms(this.resize.bind(this))}))}onHandle(){return Kr(this,void 0,void 0,(function*(){return this.handleUpdate(),!0}))}onRefresh(){return Kr(this,void 0,void 0,(function*(){return this.handleUpdate(),!0}))}onRemove(){return Kr(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}handleUpdate(){this._resizeValueCalculator=jr(this.args.mode),this._isIntersecting=G(this.element),this._task.setTimeout(this.args.delay),this.setNewValue(P(window.innerWidth)),this.updateElement()}resize(t){this.setNewValue(t.current),this.updateElement()}onIntersection(t){t.length>0&&(this._isIntersecting=t[0].isIntersecting),this.updateElement()}setNewValue(t){let e=this._resizeValueCalculator.get(this.args,t);e!==this._currentValue&&(this._currentValue=e)}updateElement(){this.cannotUpdate()||this._currentValue&&this._lastValue!==this._currentValue&&(this._lastValue=this._currentValue,this._task.start())}cannotUpdate(){return!this._isIntersecting&&"smart"===this.args.mode}updateAction(){let t=zt.get(this._currentValue);this._interactions.mutate(()=>{this._currentAction&&this._currentAction.remove(this.element),t.add(this.element),this._currentAction=t})}}function Zr(t){let e=!1,i=!1;return{perform:s=>{t(s),e&&s.preventDefault(),i&&s.stopPropagation()},stopPropagation:t=>i=t,preventDefault:t=>e=t}}var Qr=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Jr extends os{constructor(){super({props:{behavior:{corrector:t=>U(t,"auto","smooth")}}}),this.target="",this.parent="",this.behavior="auto",this.stopPropagation=!1,this.prevent=!1}}function to(t){return ls({prefix:t,name:"scroll",create:(t,e,i,s)=>new eo(t,e,s)})}class eo extends ns{constructor(t,e,i){super("CuiScrollHandler",t,i,new Jr,e),this._busFacade=Zi(this.cuid,e.bus,t),this._clickPerformer=Zr(this.onClick.bind(this)),this.extend(cs({element:t,performer:this._clickPerformer}))}onHandle(){return Qr(this,void 0,void 0,(function*(){return this.handleUpdate(),!0}))}onRefresh(){return Qr(this,void 0,void 0,(function*(){return this.handleUpdate(),!0}))}onRemove(){return Qr(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}handleUpdate(){this._clickPerformer.preventDefault(this.args.prevent),this._clickPerformer.stopPropagation(this.args.stopPropagation)}onClick(t){const e=this.getTarget(),i=this.getTargetsParent(e);if(!e||!i)return;let s=O(e)-i.offsetTop,n=s-i.scrollTop;i.scrollBy({top:n,behavior:this.args.behavior}),this._busFacade.emit(w.ON_SCROLL,{to:s,by:n,target:e,parent:i})}getTarget(){return x(this.args.target)?document.querySelector(this.args.target):null}getTargetsParent(t){return x(this.args.parent)?document.querySelector(this.args.parent):t?t.parentElement:null}}var io=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class so{constructor(t,e){this.type="switch",this.description="",this._busFacade=t,this._switchEventId=null,this._callback=e}init(t){return io(this,void 0,void 0,(function*(){return this._switchEventId=this._busFacade.on(w.SWITCH,this.onSwitch.bind(this)),!0}))}destroy(){return io(this,void 0,void 0,(function*(){return this._busFacade.detach(w.SWITCH,this._switchEventId),!0}))}onSwitch(t){t&&this._callback(t)}}function no(t,e,i){return"x"===t?function(t,e){function i(i){t.scrollTo({left:i,top:0,behavior:e})}return{scrollTo:t=>{i(t)},toIndex:e=>{i(e*t.getWidth())},getPagesCount:()=>ro(t.getScrollWidth(),t.getWidth()),getCurrentPage:()=>ro(t.getScrollLeft(),t.getWidth()),toLast:()=>{i(t.getScrollWidth()-t.getWidth())},toPercent:e=>{i(e/100*t.getScrollWidth())},toSelector:e=>{const s=t.queryAll(e);if(0===s.length)return!1;return i(function(t){if(!x(t))return-1;let e=t.offsetLeft-parseInt(N(t,"margin-left"))-parseInt(N(t,"padding-left"))-parseInt(N(t,"border-left-width"));return e<0?t.offsetLeft:e}(s[0])-t.getLeft()),!0}}}(e,i):function(t,e){function i(i){t.scrollTo({left:0,top:i,behavior:e})}return{scrollTo:t=>{i(t)},toIndex:e=>{i(e*t.getHeight())},getPagesCount:()=>ro(t.getScrollHeight(),t.getHeight()),getCurrentPage:()=>ro(t.getScrollTop(),t.getHeight()),toLast:()=>{i(t.getScrollHeight()-t.getHeight())},toPercent:e=>{i(e/100*t.getScrollHeight())},toSelector:e=>{const s=t.queryAll(e);if(0===s.length)return!1;return i(O(s[0])-t.getTop()),!0}}}(e,i)}function ro(t,e){return Math.ceil(t/e)}const oo=[function(){let t=-1;return{name:"percent",check:e=>{if(!e.match("%"))return!1;const i=e.substring(0,e.length-1);return t=parseInt(i),!isNaN(t)},perform:(e,i,s)=>(i.toPercent(t),!0)}}(),function(){let t=0;return{name:"index",check:e=>(t=parseInt(e),!isNaN(t)),perform:(e,i,s)=>(i.toIndex(t>0?t-1:t),!0)}}(),ao("first",t=>(t.scrollTo(0),!0)),ao("last",t=>(t.toLast(),!0)),ao("next",(t,e)=>{const i=t.getPagesCount(),s=t.getCurrentPage();if(s>=i-1){if(!e.loop)return!1;t.scrollTo(0)}return t.toIndex(s+1),!0}),ao("prev",(t,e)=>{const i=t.getCurrentPage();if(0===i){if(!e.loop)return!1;t.toLast()}return t.toIndex(i-1),!0}),{name:"target",check:t=>!0,perform:(t,e,i)=>e.toSelector(t)}];function ao(t,e){return{name:t,check:e=>e===t,perform:(t,i,s)=>e(i,s)}}var ho=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class co extends os{constructor(){super(),this.mode="auto",this.direction="y",this.loop=!1,this.switch=""}}function lo(t){return ls({prefix:t,name:"scroll-switch",create:(t,e,i,s)=>new uo(t,s,e)})}class uo extends ns{constructor(t,e,i){super("CuiScrollSwitchHandler",t,e,new co,i),this._busFacade=Zi(this.cuid,i.bus,t),this._root=fr.get(t),this._scrollPerformers=oo,this.setArgs(),this.extend(new so(this._busFacade,this.switch.bind(this)))}onHandle(){return ho(this,void 0,void 0,(function*(){return this.setArgs(),!0}))}onRefresh(){return ho(this,void 0,void 0,(function*(){return this.setArgs(),!0}))}onRemove(){return ho(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}switch(t){if(!t)return;const e=this._scrollPerformers.find(e=>e.check(t));if(!e)return void this.logWarning("Cannot find matching performer","switch");e.perform(t,this._helper,{behavior:this.args.mode,loop:this.args.loop})?(this.emitSwitch(t),this._busFacade.emit(w.SWITCHED,{timestamp:Date.now(),index:t})):this.logWarning("Switch "+e.name+" was not performed","switch")}setArgs(){this._helper=no(this.args.direction,this._root,this.args.mode)}emitSwitch(t){return ho(this,void 0,void 0,(function*(){if(!x(this.args.switch))return!1;const e=X(this.args.switch),i=[];return e.forEach(e=>{i.push(this.core.bus.emit(w.SWITCH,e.$cuid,t))}),yield Promise.all(i),!0}))}}class fo{static get(t){return"multi"===t?new go:new mo}}class po{constructor(t){this.previous=t}getMatching(t,e){return e.reduce((e,i,s)=>(i.verticalRatio>t&&e.push(s),e),[])}addActions(t,...e){this.forEachAction(t,e,(t,e)=>{t.add(e)})}removeActions(t,...e){this.forEachAction(t,e,(t,e)=>{t.remove(e)})}forEachAction(t,e,i){S(t,e,i)&&t.forEach(t=>{e.forEach(e=>{x(e)&&i(t,e)})})}}class mo extends po{constructor(){super(-1)}update(t,e,i,s,n){let r=this.getMatching(e,t),o=r.length,a=o>0?r[o-1]:-1,h={changed:!1};if(!this.matches(a)){if(this.previous>-1&&this.removeActions(i,t[this.previous].element),a>-1){let e=t[a].element;h.intersecting=[e],this.addActions(i,e)}return S(s,n)&&(this.previous>-1&&this.removeActions(n,s[this.previous]),a>-1&&this.addActions(n,s[a])),this.previous=a,h.changed=!0,h.intersecting=[],h}return h}matches(t){return t===this.previous}}class go extends po{constructor(){super([])}update(t,e,i,s,n){let r=this.getMatching(e,t),o={changed:!1};if(!this.matches(r)){let e=r.map(e=>t[e].element);return this.removeActions(i,...this.previous.map(e=>t[e].element)),this.addActions(i,...e),o.intersecting=e,S(s,n)&&(this.removeActions(n,...this.previous.map(t=>s[t])),this.addActions(n,...r.map(t=>s[t]))),this.previous=r,o.changed=!0,o}return o}matches(t){let e=t.length;if(e!==this.previous.length)return!1;let i=0;for(i=0;i<e;i++)if(!this.previous.includes(t[i]))return!1;return!0}}var vo=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class _o extends os{constructor(){super({props:{selector:{corrector:j},ratio:{corrector:t=>E(t,0,1,0)},mode:{corrector:t=>U(t,"single","multi")}}}),this.ratio=0,this.mode="single",this.threshold=-1,this.selector=j("> *"),this.action="",this.link="",this.linkAction=""}}function wo(t){return ls({prefix:t,name:"scrollspy",create:(t,e,i,s)=>new bo(t,e,s)})}class bo extends ns{constructor(t,e,i){super("CuiScrollspyHandler",t,i,new _o,e),this._links=[],this._actions=[],this._linkActions=[],this._modeHandler=fo.get(this.args.mode),this._interactions=Qi(e.interactions),this._busFacade=Zi(this.cuid,e.bus,t);const s=t.hasAttribute(m)?window:t;this._root=fr.get(s),this._intersectionPerformer=br({callback:this.onIntersection.bind(this),element:s}),this.extend(_r({element:s,performer:this._intersectionPerformer,threshold:5}))}onHandle(){return vo(this,void 0,void 0,(function*(){return this.updateSetup(),this._intersectionPerformer.callInitialEvent(),!0}))}onRefresh(){return vo(this,void 0,void 0,(function*(){return this.updateSetup(),!0}))}onRemove(){return vo(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}onIntersection(t){let e=Date.now();this._interactions.mutate(()=>{let i=this._modeHandler.update(t.items,this.args.ratio,this._actions,this._links,this._linkActions);i.changed&&this._busFacade.emit(w.TARGET_CHANGE,{intersecting:i.intersecting,timestamp:e})}),this._busFacade.emit(w.ON_SCROLL,{top:t.top,left:t.left,scrolling:t.scrolling,initial:t.initial})}updateSetup(){let t=this.args.selector?this._root.queryAll(this.args.selector):[];this._intersectionPerformer.setChildren(t),this._links=this.args.link?[...document.querySelectorAll(this.args.link)]:[],this._actions=Vt.get(this.args.action),this._linkActions=Vt.get(this.args.linkAction),this._modeHandler=fo.get(this.args.mode)}}class yo{constructor(){this._elements=[],this._count=0,this._threshold=5}setElements(t){this._elements=t,this._count=this._elements.length}setThreshold(t){this._threshold=t}detect(t,e){if(!x(this._elements))return[-1,void 0];let i=-1,s=void 0;for(let n=0;n<this._count;n++)if(this.isInBounds(this._elements[n],t,e)){0===n?(i=n,s=this._elements[n]):n<this._count-1&&(i=n+1,s=this._elements[n+1]);break}return[i,s]}isInBounds(t,e,i){const s=t.getBoundingClientRect();return e>s.left-this._threshold&&e<s.left+s.width+this._threshold&&i>s.top-this._threshold&&i<s.top+s.height+this._threshold}}var xo=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Co extends os{constructor(){super({props:{target:{corrector:j},trigger:{corrector:j}}}),this.target=j(" > *"),this.trigger=j(" > *"),this.timeout=150,this.threshold=5}}function Ao(t){return ls({prefix:t,name:"sortable",create:(t,e,i,s)=>new ko(t,s,e,i)})}class ko extends ns{constructor(t,e,i,s){super("CuiSortableHandler",t,e,new Co,i),this._targets=[],this._triggers=[],this._currentIdx=-1,this._currentTarget=null,this._currentBefore=null,this._preview=null,this._movingCls=D("{prefix}-moving",s),this._previewCls=D("{prefix}-sortable-preview",s),this._lockedCls=D("{prefix}-locked",s),this._busFacade=Zi(this.cuid,i.bus,t),this._interactions=Qi(i.interactions),this._dragPerformer=function(t){let e=100,i=null;function s(){i&&(clearTimeout(i),i=null)}function n(t,e){s(),e&&e(t)}return Object.assign(Object.assign({},ps({onStart:n=>ds(this,void 0,void 0,(function*(){return s(),console.log("sssss"),new Promise(s=>{i=setTimeout(()=>{i=null,console.log("start"),t.onStart(n).then(t=>{s(t)})},e)})})),onMove:e=>n(e,t.onMove),onEnd:e=>n(e,t.onEnd)})),{setTimeout:t=>{e=t}})}({onStart:this.onDragStart.bind(this),onMove:this.onDragOver.bind(this),onEnd:this.onDragEnd.bind(this)}),this._detector=new yo,this._animation=new zs(class{static get(t){return new $s(t)}}.get(Vs())),this.extend(Rn({target:t,performer:this._dragPerformer}))}onHandle(){return xo(this,void 0,void 0,(function*(){return this.getTargetsAndTrggers(),this._detector.setThreshold(this.args.threshold),this._dragPerformer.setTimeout(this.args.timeout),!0}))}onRefresh(){return xo(this,void 0,void 0,(function*(){return!this.prevArgs||this.args.target===this.prevArgs.target&&this.args.trigger===this.prevArgs.trigger||this.getTargetsAndTrggers(),this._dragPerformer.setTimeout(this.args.timeout),!0}))}onRemove(){return xo(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}getTargetsAndTrggers(){this._targets=[...this.element.querySelectorAll(this.args.target)],this._triggers=[...this.element.querySelectorAll(this.args.trigger)],this._triggers.length!==this._targets.length&&(this.log.error("Incorrect trigger or target selector"),this._targets=[],this._triggers=[]),this._detector.setElements(this._targets)}onDragStart(t){return xo(this,void 0,void 0,(function*(){return this._currentIdx=this.getPressedElementIdx(t.target),this._currentTarget=this._currentIdx>-1?this._targets[this._currentIdx]:null,!!x(this._currentTarget)&&(this.core.bus.emit(w.MOVE_LOCK,null,!0),this.startMovementPrep(t),this._busFacade.emit(w.SORT_START,{target:this._currentTarget,index:this._currentIdx}),!0)}))}onDragOver(t){this.move(t),t.event.preventDefault()}onDragEnd(t){x(this._preview)&&(this._animation.setElement(this._preview),this._animation.setProps(this.getFinishAnimation()),this._animation.finish({progress:0,timeout:100,revert:!1}).then(t=>{t&&this.onSortAnimationFinish()}))}getPressedElementIdx(t){return this._triggers.findIndex(e=>e.contains(t))}startMovementPrep(t){this._interactions.mutate(()=>{this.createPreview(),x(this._currentTarget)&&this.classes.setClass(this._movingCls,this._currentTarget),this.classes.setClass(this._lockedCls,this.element),this.classes.setClass(p,document.body),this.setPreviewPosition(t),this.setCurrentPosition(t)})}stopMovementPrep(){this._interactions.mutate(()=>{x(this._currentTarget)&&this.classes.removeClass(this._movingCls,this._currentTarget),this.classes.removeClass(p,document.body),this.classes.removeClass(this._lockedCls,this.element),this.removePreview(),this._currentTarget=null,this._currentBefore=null,this.getTargetsAndTrggers()})}move(t){this._interactions.mutate(()=>{this.setPreviewPosition(t),this.setCurrentPosition(t)})}createPreview(){x(this._currentTarget)?(this._preview=new he("div").setClasses(this._previewCls).build(),this._preview.style.width=this._currentTarget.offsetWidth+"px",this._preview.style.height=this._currentTarget.offsetHeight+"px",document.body.appendChild(this._preview)):this.logError("Cannot create preview - current target does not exist","createPreview")}removePreview(){x(this._preview)&&(this._preview.remove(),this._preview=null)}setPreviewPosition(t){x(this._preview)&&(this._preview.style.top=t.y+"px",this._preview.style.left=t.x+"px")}setCurrentPosition(t){if(!this._currentTarget)return;let[e,i]=this._detector.detect(t.x,t.y);if(e!==this._currentIdx&&i&&this._currentBefore!==i){let t=i;this.insertElement(this._currentTarget,t),this._currentBefore=t,this.getTargetsAndTrggers(),this._currentIdx=e}}insertElement(t,e){x(e)?this.element.insertBefore(t,e):this.element.appendChild(t)}getFinishAnimation(){if(!S(this._currentTarget,this._preview))return{opacity:{from:1,to:0}};const t=this._currentTarget.getBoundingClientRect();return{opacity:{from:1,to:0},top:{from:this._preview.offsetTop,to:t.top>0?t.top:this._preview.offsetTop,unit:"px"},left:{from:this._preview.offsetLeft,to:t.left>0?t.left:this._preview.offsetLeft,unit:"px"}}}onSortAnimationFinish(){this.stopMovementPrep(),this.core.bus.emit(w.MOVE_LOCK,null,!1),this._busFacade.emit(w.SORTED,{target:this._currentTarget,index:this._currentIdx})}}var Eo=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class To extends os{constructor(){super({main:"spinner"}),this.spinner="circle",this.scale=1}}function So(t){return g.spinner_circle='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path d="M 7.800378,1.7908996 A 8.4986862,8.4986862 0 0 1 18.2091,7.8003784 8.4986862,8.4986862 0 0 1 12.199621,18.209101 8.4986862,8.4986862 0 0 1 1.7908995,12.199622 8.4986862,8.4986862 0 0 1 7.800378,1.7908996 Z"></path></svg>',g.spinner_circle_double='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path d="M 10,1.5000006 A 8.4999997,8.4999997 0 0 1 18.5,10 8.4999997,8.4999997 0 0 1 10,18.499999 8.4999997,8.4999997 0 0 1 1.5000005,10 8.4999997,8.4999997 0 0 1 10,1.5000006 Z"></path><path d="M 10,3.4999997 A 6.5000002,6.5000002 0 0 1 16.5,10 6.5000002,6.5000002 0 0 1 10,16.5 6.5000002,6.5000002 0 0 1 3.5,9.9999993 6.5000002,6.5000002 0 0 1 10,3.4999997 Z"></path></svg>',ls({prefix:t,name:"spinner",create:(t,e,i,s)=>new Po(t,e,s,i)})}class Po extends ns{constructor(t,e,i,s){super("CuiSpinnerHandler",t,i,new To,e),this._busFacade=Zi(this.cuid,e.bus,t),this._animationPauseClass=D("{prefix}-animation-pause",s),this._interactionFacade=Qi(e.interactions,this),this.extend(ys(this._busFacade,{eventName:w.PAUSE,type:"pause",performer:ms(this.onPause.bind(this))}))}onHandle(){return Eo(this,void 0,void 0,(function*(){return this.add(),!0}))}onRefresh(){return Eo(this,void 0,void 0,(function*(){return this.prevArgs&&this.args.spinner!==this.prevArgs.spinner&&this.add(),!0}))}onRemove(){return Eo(this,void 0,void 0,(function*(){return this.removeIfAnyExisists(),!0}))}addSpinner(t,e){this.element.appendChild(t),this.element.classList.add("animation-spinner-"+e)}add(){const t=x(this.args.spinner)?g["spinner_"+this.args.spinner]:null;if(!x(t))return void this.log.warning("Incorrect spinner name: "+this.args.spinner);this.removeIfAnyExisists();const e=new ui(t).setScale(this.args.scale).build();this._interactionFacade.mutate(this.addSpinner,e,this.args.spinner)}removeIfAnyExisists(){let t=this.element.querySelector("svg");t&&t.remove()}onPause(t){this._interactionFacade.fetch(()=>{t&&!this.classes.hasClass(this._animationPauseClass,this.element)?this.asyncClasses.setClasses(this.element,this._animationPauseClass):this.asyncClasses.removeClasses(this.element,this._animationPauseClass)}),this._busFacade.emit(w.PAUSED,{paused:t})}}var Lo=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Io extends os{constructor(t,e){super({props:{targets:{corrector:j},swipeRatio:{corrector:t=>E(t,.1,.9,.4)}}}),this.targets=j(" > li"),this.links="",this.autoTimeout=-1,this.height="",this.animation="slide",this.loop=!1,this.timeout=null!=e?e:300,this.swipeRatio=.3,this.keyChange=!1}}function Oo(t){return ls({prefix:t,name:"slider",create:(t,e,i,s)=>new Mo(t,e,s)})}class Mo extends ns{constructor(t,e,i){super("CuiSliderHandler",t,i,new Io(e.setup.prefix,e.setup.animationTime),e),this._targets=[],this._currentIdx=-1,this._nextIdx=-1,this._links=[],this._current=void 0,this._nextElement=null,this._currSlider=new zs(new $s(Vs())),this._nextSlider=new zs(new $s(Vs())),this._targetsCount=0,this._task=new Cn(this.args.autoTimeout,!0,this.switch.bind(this,"next")),this._animationDef=Qt[this.args.animation],this._keysPerformer=rn(this.switch.bind(this)),this._busFacade=Zi(this.cuid,e.bus,this.element),this._interactions=Qi(e.interactions),this._task=new Cn(this.args.autoTimeout,!0,this.switch.bind(this,"next")),this._styles=new es,this._mutationPerformer=Fr(this.onMutation.bind(this)),this._movePerformer=ws(this.asyncClasses,{element:t,prevent:!0,start:this.onDown.bind(this),progress:this.onMove.bind(this),end:this.onUp.bind(this),adjustRatio:this.adjustMoveRatio.bind(this)}),this.extend(new so(this._busFacade,this.switch.bind(this))),this.extend(new nn(this.element,this._busFacade,this._keysPerformer)),this.extend(ys(this._busFacade,{type:"global-move",eventName:w.GLOBAL_MOVE,performer:this._movePerformer})),this.extend(new Hr(t,this._mutationPerformer))}onHandle(){return Lo(this,void 0,void 0,(function*(){return this.getTargets(),this.getLinks(),this.getActiveIndex(),this.setLinkActive(-1,this._currentIdx),this.setElementHeight(),this.handleUpdate(),!0}))}onRefresh(){return Lo(this,void 0,void 0,(function*(){return this.setElementHeight(),this.handleUpdate(),!0}))}onRemove(){return Lo(this,void 0,void 0,(function*(){return this._task.stop(),this._busFacade.detachEmittedEvents(),!0}))}onMutation(t){this.getTargets(),this.getLinks()}handleUpdate(){this._animationDef=Qt[this.args.animation],this._mutationPerformer.setSelector(this.args.targets),this.setKeyCombo(this.args.keyChange),this.startTask()}setElementHeight(){this._interactions.mutate(()=>{this._styles.setStyle("height",this.getElementHeight(this._targets[this._currentIdx]),this.element)})}onDown(){return!!this.lock()&&(this._current=this._targets[this._currentIdx],this._currSlider.setElement(this._current),!0)}onMove(t){if(!this._current)return;const e=t.ratio>0?"right":"left",i=Math.abs(t.ratio);let s=V("left"===e?"next":"prev",this._currentIdx,this._targetsCount);s!==this._nextIdx&&(this._nextElement&&this.classes.removeClass(d,this._nextElement),this._nextElement=this._targets[s],this._nextIdx=s,this._nextSlider.setElement(this._nextElement),this._nextSlider.setProps(this._animationDef.previous[e]),this._currSlider.setProps(this._animationDef.current[e]),this._interactions.mutate(()=>{this._nextElement&&this.classes.setClass(d,this._nextElement)})),this._interactions.mutate(()=>{this._currSlider.move(Math.abs(i)),this._nextSlider.move(Math.abs(i))})}onUp(t){let e=Math.abs(t.ratio);const i=1/this.args.timeout,s=t.velocity>i?t.velocity:i;let n=e<=this.args.swipeRatio;Promise.all([this._currSlider.finish({progress:e,acceleration:t.acceleration,velocity:s,timeout:this.args.timeout,revert:n}),this._nextSlider.finish({progress:e,acceleration:t.acceleration,velocity:s,timeout:this.args.timeout,revert:n})]).then(t=>{t&&this.onAnimationFinish(this._current,n,!1)}).catch(t=>{this.logError("An error","onUp",t),this.onAnimationFinish(this._current,n,!0)})}adjustMoveRatio(t){return this.args.loop?t:0===this._currentIdx&&t>0||this._currentIdx===this._targetsCount-1&&t<0?0:t}switch(t){return Lo(this,void 0,void 0,(function*(){return!!this.lock()&&(this.onPushSwitch(t),!0)}))}onAnimationFinish(t,e,i){let s=this._targets[this._nextIdx],n=this._targets[this._currentIdx];this._interactions.mutate(()=>{this.classes.removeClass(d,s),this._styles.clean(n),this._styles.clean(s),e||(this.classes.setClass(this.activeClassName,s),this.classes.removeClass(this.activeClassName,n),this.setLinkActive(this._currentIdx,this._nextIdx),this._busFacade.emit(w.SWITCHED,{timestamp:Date.now(),index:this._nextIdx}),this._currentIdx=this._nextIdx),this.clearSlideData(),this.unlock()}),this.startTask()}onPushSwitch(t){if(!x(t)||!this._animationDef||!this.args.loop&&0===this._currentIdx&&"prev"===t||!this.args.loop&&this._currentIdx===this._targetsCount-1&&"next"===t)return void this.unlock();let e=V(t,this._currentIdx,this._targetsCount);if(e==this._currentIdx||e<0||e>=this._targets.length)return this.log.warning(`Index ${t} is not within the suitable range`),!1;this._nextIdx=e;let i=this._targets[this._currentIdx],s=this._targets[this._nextIdx];this._currSlider.setElement(i),this._nextSlider.setElement(s),this._currSlider.setProps("prev"===t?this._animationDef.current.left:this._animationDef.current.right),this._nextSlider.setProps("prev"===t?this._animationDef.previous.left:this._animationDef.previous.right),this._interactions.mutate(()=>{this.classes.setClass(d,s)}),Promise.all([this._currSlider.finish({progress:0,acceleration:1,velocity:0,timeout:this.args.timeout,revert:!1}),this._nextSlider.finish({progress:0,acceleration:1,velocity:0,timeout:this.args.timeout,revert:!1})]).then(t=>{var e,s;(s=t=>!0===t,(e=t)&&e.length>0&&void 0===e.find(t=>!s(t)))&&this.onAnimationFinish(i,!1,!1)}).catch(t=>{this.logError("An error","onUp",t),this.onAnimationFinish(i,!1,!0)})}getActiveIndex(){this._currentIdx=x(this._targets)?this._targets.findIndex(t=>this.classes.hasClass(this.activeClassName,t)):-1}clearSlideData(){this._nextIdx=-1,this._nextElement=null}getElementHeight(t){return x(this.args.height)&&"auto"!==this.args.height?this.args.height:$(t)+"px"}setKeyCombo(t){t?this._keysPerformer.setKeyCombos([{key:"next",value:hn("ArrowRight")},{key:"prev",value:hn("ArrowLeft")}]):this._keysPerformer.setKeyCombos([])}getTargets(){this._targets=[...this.element.querySelectorAll(this.args.targets)],this._targetsCount=this._targets.length}getLinks(){this._links=x(this.args.links)?[...document.querySelectorAll(this.args.links)]:[]}setLinkActive(t,e){x(this._links)&&this._interactions.mutate(()=>{H(t,0,this._links.length-1)&&this.classes.removeClass(this.activeClassName,this._links[t]),H(e,0,this._links.length-1)&&this.classes.setClass(this.activeClassName,this._links[e])})}startTask(){this._task.stop(),this.args.autoTimeout&&this._task.start()}}var No=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Ho extends os{constructor(t,e){super({props:{targets:{corrector:j}}}),this.targets=j(" > *"),this.in=D(".{prefix}-switch-animation-default-in",t),this.out=D(".{prefix}-switch-animation-default-out",t),this.timeout=null!=e?e:300,this.links="",this.switch="",this.autoTimeout=-1,this.height="auto",this.loop=!1,this.keyChange=!1}}function Fo(t){return ls({prefix:t,name:"switch",create:(t,e,i,s)=>new Wo(t,e,s)})}class Wo extends ns{constructor(t,e,i){super("CuiSwitchHandler",t,i,new Ho(e.setup.prefix,e.setup.animationTime),e),this._targets=[],this._actionsHelper=new Mt(e.interactions),this._asyncStyles=new is(e.interactions,new es),this._task=new Cn(this.args.autoTimeout,!0,this.switch.bind(this,"next")),this._busFacade=Zi(this.cuid,e.bus,this.element),this._switchPerformer=rn(this.switch.bind(this)),this._mutationPerformer=Fr(this.onMutation.bind(this)),this.extend(new nn(this.element,this._busFacade,this._switchPerformer)),this.extend(new so(this._busFacade,this.switch.bind(this))),this.extend(new Hr(t,this._mutationPerformer))}onHandle(){return No(this,void 0,void 0,(function*(){return this.handleUpdate(),!0}))}onRefresh(){return No(this,void 0,void 0,(function*(){return this.handleUpdate(),!0}))}onRemove(){return No(this,void 0,void 0,(function*(){return this._task.stop(),this._busFacade.detachEmittedEvents(),!0}))}handleUpdate(){this.parseArguments(),this.getTargets();const t=this.getActiveIndex();this.setSwitchesActive(t),this.setLinkActive(-1,t),this.setTargetHeight(t),this.startTask()}onMutation(t){this.getTargets();const e=this.getActiveIndex();this.setTargetHeight(e)}switch(t){return No(this,void 0,void 0,(function*(){if(!this.lock())return!1;const e=Vt.get(this.args.in),i=Vt.get(this.args.out),s=this.getActiveIndex(),n=V(t,s,this._targets.length);if(n<0)return this.logWarning(`Index ${t} is not within the suitable range`,"switch"),!1;if(!this.args.loop&&("next"===t&&0===n||"prev"===t&&0===s))return this.logInfo("Switch blocked by loop settings","switch"),!1;this.setSwitchesActive(n);let r=this._targets[n];return yield this._actionsHelper.performSwitchAction(r,s>-1?this._targets[s]:null,e,i,()=>{r.classList.add(this.activeClassName),s>-1&&this._targets[s].classList.remove(this.activeClassName),this.setLinkActive(s,n),this.setTargetHeight(s),this.startTask(),this.unlock()},this.args.timeout),this._busFacade.emit(w.SWITCHED,{timestamp:Date.now(),index:n}),!0}))}getActiveIndex(){return x(this._targets)?this._targets.findIndex(t=>this.classes.hasClass(this.activeClassName,t)):-1}getElementHeight(t){return x(this.args.height)&&"auto"!==this.args.height?this.args.height:$(t)+"px"}parseArguments(){this._task.setTimeout(this.args.autoTimeout),this.args.keyChange?this._switchPerformer.setKeyCombos([{key:"next",value:{isCtrl:!0,isAlt:!0,isShift:!1,key:"ArrowRight"}},{key:"prev",value:{isCtrl:!0,isAlt:!0,isShift:!1,key:"ArrowLeft"}}]):this._switchPerformer.setKeyCombos([])}getTargets(){this._targets=x(this.args.targets)?[...this.element.querySelectorAll(this.args.targets)]:[]}setLinkActive(t,e){const i=x(this.args.links)?[...document.querySelectorAll(this.args.links)]:null;if(!i)return;const s=i.length-1;H(t,0,s)&&this.classes.removeClass(this.activeClassName,i[t]),H(e,0,s)&&this.classes.setClass(this.activeClassName,i[e])}setSwitchesActive(t){X(this.args.switch).forEach(e=>{this.emitLinkSwitch(e.$cuid,t)})}emitLinkSwitch(t,e){x(t)&&this.core.bus.emit(w.SWITCH,t,e)}startTask(){this._task.stop(),this.args.autoTimeout&&this._task.start()}setTargetHeight(t){this._asyncStyles.setStyle("height",this.getElementHeight(this._targets[t]),this.element)}}var Do=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Ro extends os{constructor(){super(),this.index="",this.target="",this.prevent=!1,this.stopPropagation=!1,this.targets="li > a",this.isList=!1}}function Bo(t){return ls({prefix:t,name:"switcher",create:(t,e,i,s)=>new $o(t,e,s)})}class $o extends ns{constructor(t,e,i){super("CuiSwitcherHandler",t,i,new Ro,e),this._perfromer=Zr(this.onClickEvent.bind(this)),this.extend(cs({element:t,performer:this._perfromer}))}onHandle(){return Do(this,void 0,void 0,(function*(){return this.handleArguments(),!0}))}onRefresh(){return Do(this,void 0,void 0,(function*(){return this.handleArguments(),!0}))}onRemove(){return Do(this,void 0,void 0,(function*(){return!0}))}handleArguments(){this._perfromer.preventDefault(this.args.prevent),this._perfromer.stopPropagation(this.args.stopPropagation)}getTargetCuid(){let t=null;x(this.args.target)||(t=null);let e=document.querySelector(this.args.target);return x(e)&&(t=e.$cuid),t}onClickEvent(t){const e=this.getTargetCuid();e&&(this.args.isList||"UL"===this.element.tagName?this.handleListClick(t,e):this.handleItemClick(t,e))}handleItemClick(t,e){this.args.index?this.core.bus.emit(w.SWITCH,e,this.args.index):this.log.warning("Switch cannot be performed since component doesn't specify index")}handleListClick(t,e){const i=K(this.args.targets);if(!t.target.matches(i))return;const s=[...this.element.querySelectorAll(this.args.targets)].findIndex(e=>e===t.target);s<0||this.core.bus.emit(w.SWITCH,e,s)}}var zo=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Vo extends os{constructor(){super({main:"action"}),this.action="",this.target="",this.prevent=!1,this.stopPropagation=!1}}function qo(t){return ls({name:"toggle",prefix:t,create:(t,e,i,s)=>new Uo(t,e,s)})}class Uo extends ns{constructor(t,e,i){super("CuiToggleHandler",t,i,new Vo,e),this._busFacade=Zi(this.cuid,e.bus,t),this._interactions=Qi(e.interactions),this.extend(cs({element:t,performer:ms(this.toggle.bind(this))})),this.extend(ys(this._busFacade,{eventName:w.TOGGLE,performer:ms(this.toggle.bind(this))}))}onHandle(){return zo(this,void 0,void 0,(function*(){return!0}))}onRefresh(){return zo(this,void 0,void 0,(function*(){return!0}))}onRemove(){return zo(this,void 0,void 0,(function*(){return this._busFacade.detachEmittedEvents(),!0}))}toggle(){const t=this.getTarget();if(!t)return void this.logError("Target in not provided","toggle");const e=Vt.get(this.args.action);this._interactions.mutate(()=>{e.forEach(e=>e.toggle(t,this.core)),this._busFacade.emit(w.TOGGLED,{action:this.args.action,target:t,timestamp:Date.now()})})}getTarget(){var t;return this.args.target&&null!==(t=document.querySelector(this.args.target))&&void 0!==t?t:this.element}}var jo=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};class Ko extends os{constructor(t){super({main:"content"}),this.content="",this.width=150,this.margin=8,this.timeout=2e3,this.pos="",this.action=D(".{prefix}-animation-tooltip-in",t)}}function Go(t){const e=null!=t?t:"cui",i=e+"-tooltip";return{attribute:i,get:(t,s)=>new Yo(t,i,s,e)}}class Yo extends ns{constructor(t,e,i,s){super("CuiTooltipHandler",t,e,new Ko(s),i),this._tooltip=void 0,this._tooltipDataCls=D("{prefix}-tooltip-data",s),this._positionCalculator=new xn,this._positionCalculator.setPreferred("top-center"),this._interactions=Qi(i.interactions),this._task=new Cn(this.args.timeout,!1,this.removeTooltip.bind(this)),this.extend(function(t){var e;const i=new bn(t.element);function s(e){t.performer.perform(e)}return{type:null!==(e=t.type)&&void 0!==e?e:"hover",init:()=>An(this,void 0,void 0,(function*(){return i.setCallback(s),i.attach(),!0})),destroy:()=>An(this,void 0,void 0,(function*(){return i.detach(),!0}))}}({element:t,performer:ms(this.onHover.bind(this))}))}onHandle(){return jo(this,void 0,void 0,(function*(){return this.getDataFromArgs(),!0}))}onRefresh(){return jo(this,void 0,void 0,(function*(){return this.getDataFromArgs(),!0}))}onRemove(){return jo(this,void 0,void 0,(function*(){return this.removeTooltip(),!0}))}onHover(t){t.isHovering?this.createTooltip():this.removeTooltip()}createTooltip(){if(x(this._tooltip)||!x(this.args.content))return;const t=this.element.getBoundingClientRect();this._tooltip=new he("div").setClasses(this._tooltipDataCls).build(),this._tooltip.textContent=this.args.content,this._tooltip.style.maxWidth=this.args.width+"px",document.body.appendChild(this._tooltip),this._interactions.mutate(()=>{if(!this._tooltip)return;const e=this._tooltip.getBoundingClientRect();this._positionCalculator.setMargin(this.args.margin);try{let[i,s]=this._positionCalculator.calculate(t,e);this._tooltip.style.top=s+"px",this._tooltip.style.left=i+"px",this.toggleActions(this._tooltip),this._task.start()}catch(t){this.logError(t.message,"createTooltip",t)}})}removeTooltip(){this._task.stop(),this._interactions.mutate(()=>{x(this._tooltip)&&(this._tooltip.remove(),this._tooltip=void 0)})}getDataFromArgs(){this._positionCalculator.setMargin(this.args.margin),this._positionCalculator.setStatic(this.args.pos),this._task.setTimeout(this.args.timeout)}toggleActions(t){Vt.get(this.args.action).forEach(e=>{e.toggle(t)})}}var Xo=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))};function Zo(t){var e,i;return Xo(this,void 0,void 0,(function*(){let s=[];try{s=function(t){var e;let i=!t||t.autoLight,s=!t||t.autoPrint;return[Je({autoLight:i}),_i({autoPrint:s}),(r={},new re({name:"keys-plugin",description:"CuiKeysObserverPlugin",setup:r,callback:(t,e)=>{const i=new Ge(t.bus);return i.connect(),[[],()=>{i.disconnect()}]}})),new re({name:"click-plugin",description:"CuiWindowClickPlugin",setup:void 0,callback:t=>{function e(e){t.bus.emit(w.WINDOW_CLICK,null,{ev:e,source:"CuiWindowClickPlugin",timestamp:Date.now(),name:w.WINDOW_CLICK})}return window.addEventListener("click",e),[[],()=>{window.removeEventListener("click",e)}]}}),new re({name:"move-observer-plugin",description:"CuiMoveObserverPlugin",setup:!0===n,callback:(t,e)=>{const i=new li(t.bus,e);return i.attach(),[[],()=>{i.isAttached()&&i.detach()}]}}),Li({}),Vi({}),Oe(),vi({timeout:t.notifcationTimeout}),Me(null!==(e=t.focusSetup)&&void 0!==e?e:{})];var n,r}({autoLight:!0,autoPrint:!0})}catch(t){return console.error("An error occured during download plugin module",t),!1}let n=[];try{n=function(t){let e=null==t?void 0:t.prefix;return[jn(e),Go(e),Xs(e),So(e),to(e),wo(e),Sr(e),tn(e),qo(e),_n(e),Jn(e),As(e),Sn(e),Ar(e),Fo(e),Bo(e),zn(e),Oo(e),js(e),fn(e),Ao(e),Yr(e),Rr(e),lo(e)]}({prefix:null===(e=t.setup)||void 0===e?void 0:e.prefix})}catch(t){return console.error("An error occured during download components module",t),!1}let r=s;t.plugins&&(r=Object.assign(Object.assign({},s),t.plugins));let o=yield function(t){return Jt(this,void 0,void 0,(function*(){const e=window;let i=Object.assign(Object.assign({},new Q),t.setup);const s={result:!1},n=[se(e,i.app),te,ee,ie(e,i)];for(let e of n){const i=yield e(t);if(i)return s.message=i,s}return s.result=!0,s}))}(Object.assign(Object.assign({},t),{plugins:r,components:x(t.components)?[...n,...t.components]:n}));return!!o.result||(console.error(`A cUI instance failed to initialize: [${null!==(i=o.message)&&void 0!==i?i:"#"}]`),!1)}))}const Qo="0.5.0"}])}));
//# sourceMappingURL=cui-light.min.js.map